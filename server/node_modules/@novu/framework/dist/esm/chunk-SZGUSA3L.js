import{$ as gr,A as Cn,B as dr,C as $n,D as xn,E as Dn,F as Fn,G as Wn,H as Un,I as jn,J as hr,K as Bn,L as mr,M as Vn,N as Yn,R as Hn,S as qn,T as Kn,U as Jn,V as Gn,W as Qn,X as Zn,Z as zn,_ as Xn,aa as yr,c as _t,ca as pt,d as fr,da as ei,ea as ti,fa as wr,g as Nn,ga as Sr,ia as We,ja as Fe,o as pr,w as Ln,z as It}from"./chunk-J2MPR7MB.js";import{Liquid as Ls}from"liquidjs";var ri=async($,s)=>{let d=new TextEncoder,y=d.encode($),P=d.encode(s),j=await crypto.subtle.importKey("raw",y,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),x=await crypto.subtle.sign("HMAC",j,P);return Array.from(new Uint8Array(x)).map(te=>te.toString(16).padStart(2,"0")).join("")};import{Response as Rs}from"cross-fetch";var Us=()=>typeof Response!="undefined"?Response:Rs,ni=async()=>{if(process.env.NOVU_BRIDGE_ORIGIN)return`${process.env.NOVU_BRIDGE_ORIGIN}/api/novu`;if(process.env.NEXT_PUBLIC_VERCEL_ENV==="preview"&&process.env.NEXT_PUBLIC_VERCEL_URL)return`https://${process.env.NEXT_PUBLIC_VERCEL_URL}/api/novu`;try{if(process.env.NODE_ENV==="development"){let s=await(await fetch("http://localhost:2022/.well-known/novu")).json();return`${s.tunnelOrigin}${s.route}`}}catch($){console.error($)}return""};import{checkIsResponseError as _s}from"@novu/shared";var Mt=($,s)=>{if(!$)throw new Vn;return{post:async(d,y)=>{let P=await fetch(`${s}/v1${d}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`ApiKey ${$}`},body:JSON.stringify(y)}),j=await P.json();if(P.ok)return j;throw _s(j)?new Yn(j.statusCode,j.error,j.message):new It(j)},delete:async d=>(await fetch(`${s}/v1${d}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`ApiKey ${$}`}})).json()}};import tt from"chalk";var me={info:$=>tt.blue($),warning:$=>tt.yellow($),error:$=>tt.red($),success:$=>tt.green($),underline:$=>tt.underline($),bold:$=>tt.bold($)},Ae={SUCCESS:me.success("\u2714"),ERROR:me.error("\u2717"),WARNING:me.warning("\u26A0"),INFO:me.info("\u2139"),ARROW:me.bold("\u2192"),MOCK:me.info("\u25CB"),HYDRATED:me.bold(me.info("\u2192")),STEP:me.info("\u03C3"),ACTION:me.info("\u03B1"),DURATION:me.info("\u0394"),PROVIDER:me.info("\u2699"),OUTPUT:me.info("\u21E2"),INPUT:me.info("\u21E0"),WORKFLOW:me.info("\u03C9"),STATE:me.info("\u03C3"),EXECUTE:me.info("\u03B5"),PREVIEW:me.info("\u03C1")};function kt($){return $||process.env.NOVU_API_URL||"https://api.novu.co"}function Nt($){return $||process.env.NOVU_SECRET_KEY||process.env.NOVU_API_KEY||""}import si from"sanitize-html";var Is={allowedTags:si.defaults.allowedTags.concat(["style","img","html","head","body","link","meta","title"]),allowedAttributes:!1,allowVulnerableTags:!0,parseStyleAttributes:!1,parser:{lowerCaseAttributeNames:!0}},ii=$=>{if(!$)return $;let s=/^<!DOCTYPE .*?>/,d=$.match(s),y=si($,Is);return d?d[0]+y:y},Lt=$=>Object.keys($).reduce((s,d)=>{let y=$[d];return typeof y=="string"?s[d]=ii(y):Array.isArray(y)?s[d]=y.map(P=>typeof P=="string"?ii(P):typeof P=="object"?Lt(P):P):typeof y=="object"&&y!==null?s[d]=Lt(y):s[d]=y,s},{});import ks from"ajv";import Ns from"ajv-formats";var oi=$=>typeof structuredClone=="function"?structuredClone($):JSON.parse(JSON.stringify($));var Ct=class extends Ln{constructor(d,y){let P=y.length===1?"it":"them";super(`Tried to use a ${d} in @novu/framework without ${y.join(", ")} installed. Please install ${P} by running \`npm install ${y.join(" ")}\`.`);this.statusCode=500;this.code="MissingDependencyError"}};var $t=async($,s)=>{let d=new Set;if((await Promise.allSettled($.map(P=>P.import))).forEach((P,j)=>{let x=$[j];P.status==="fulfilled"&&x.exports.every(ae=>P.value[ae]!==void 0)||d.add(x.name)}),d.size>0)throw new Ct(s,Array.from(d))};var xt=class{constructor(){this.requiredImports=[];this.ajv=new ks({useDefaults:!0,removeAdditional:"failing"}),Ns(this.ajv),this.compiledSchemas=new Map}async canHandle(s){let d=s.type==="object"||!!s.anyOf||!!s.allOf||!!s.oneOf;return d&&await $t(this.requiredImports,"JSON schema"),d}async validate(s,d){let y=this.compiledSchemas.get(d);y||(y=this.ajv.compile(d),this.compiledSchemas.set(d,y));let P=oi(s);return y(P)?{success:!0,data:P}:{success:!1,errors:y.errors.map(x=>({path:x.instancePath,message:x.message}))}}async transformToJsonSchema(s){return s}};var Dt=class{constructor(){this.requiredImports=[{name:"zod",import:import("zod"),exports:["ZodType"]},{name:"zod-to-json-schema",import:import("zod-to-json-schema"),exports:["zodToJsonSchema"]}]}async canHandle(s){let d=s.safeParseAsync!==void 0;return d&&await $t(this.requiredImports,"Zod schema"),d}async validate(s,d){let y=await d.safeParseAsync(s);return y.success?{success:!0,data:y.data}:{success:!1,errors:y.error.errors.map(P=>({path:`/${P.path.join("/")}`,message:P.message}))}}async transformToJsonSchema(s){let{zodToJsonSchema:d}=await import("zod-to-json-schema");return d(s)}};var Ft=new Dt,Wt=new xt,Ut=async($,s)=>{if(await Ft.canHandle($))return Ft.validate(s,$);if(await Wt.canHandle($))return Wt.validate(s,$);throw new Error("Invalid schema")},Re=async $=>{if(await Ft.canHandle($))return Ft.transformToJsonSchema($);if(await Wt.canHandle($))return Wt.transformToJsonSchema($);throw new Error("Invalid schema")};var jt=(()=>{var $=Object.defineProperty,s=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,y=Object.prototype.hasOwnProperty,P=(e,t)=>function(){return e&&(t=(0,e[d(e)[0]])(e=0)),t},j=(e,t)=>function(){return t||(0,e[d(e)[0]])((t={exports:{}}).exports,t),t.exports},x=(e,t)=>{for(var r in t)$(e,r,{get:t[r],enumerable:!0})},te=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of d(t))!y.call(e,l)&&l!==r&&$(e,l,{get:()=>t[l],enumerable:!(a=s(t,l))||a.enumerable});return e},ae=e=>te($({},"__esModule",{value:!0}),e),ve={};x(ve,{JSONSchemaFaker:()=>Mn,default:()=>kn,setDependencies:()=>Yr});function ke(e,t){return typeof e=="string"?typeof t!="undefined"?at.register(e,t):at.get(e):at.registerMany(e)}function Le(e,t){return e=typeof e=="undefined"?Ve.MIN_INTEGER:e,t=typeof t=="undefined"?Ve.MAX_INTEGER:t,Math.floor(z("random")()*(t-e+1))+e}function be(e){return vt.default.prototype.max=z("defaultRandExpMax"),vt.default.prototype.randInt=(r,a)=>r+Math.floor(z("random")()*(1+(a-r))),new vt.default(e).gen()}function Ne(e){return e[Math.floor(z("random")()*e.length)]}function $e(e){let t,r,a=e.length,l=e.slice();for(;a>0;)r=Math.floor(z("random")()*a),a-=1,t=l[a],l[a]=l[r],l[r]=t;return l}function Qe(e,t){return z("random")()*(t-e)+e}function Ue(e,t,r,a,l=!1){return r=typeof r=="undefined"?Ve.MIN_NUMBER:r,a=typeof a=="undefined"?Ve.MAX_NUMBER:a,e=typeof e=="undefined"?r:e,t=typeof t=="undefined"?a:t,t<e&&(t+=e),l?Qe(e,t):Le(e,t)}function yt(e){switch(e){case"seconds":return Ue(0,60)*60;case"minutes":return Ue(15,50)*612;case"hours":return Ue(12,72)*36123;case"days":return Ue(7,30)*86412345;case"weeks":return Ue(4,52)*604812345;case"months":return Ue(2,13)*2592012345;case"years":return Ue(1,20)*31104012345;default:break}}function Bt(e){if(e)return yt(e);let t=z("minDateTime"),r=z("maxDateTime");typeof t=="string"&&(t=new Date(t)),typeof r=="string"&&(r=new Date(r));let a=new Date().getTime();return typeof t=="number"&&(t=new Date(a+t)),typeof r=="number"&&(r=new Date(a+r)),new Date(Qe(t.getTime(),r.getTime()))}function br(e,t,r){if(t=decodeURIComponent(t),r&&r[t])return St(r[t]);let a=t.replace("#/","/").split("/"),l=e.$ref&&r&&r[e.$ref]||e;for(!l&&!a[0]&&(a[0]=e.$ref.split("#/")[0]),r&&t.includes("#/")&&r[a[0]]&&(l=r[a.shift()]),a[0]||a.shift();l&&a.length>0;){let f=a.shift();if(!l[f])throw new Error(`Prop not found: ${f} (${t})`);l=l[f]}return l}function wt(e){return typeof e=="string"&&en.test(e)}function je(e){return["number","boolean"].includes(typeof e)}function Be(e,...t){return t.filter(r=>typeof e[r]!="undefined").length>0}function Tr(e){if(e.includes(" "))return new Date(e).toISOString().substr(0,10);let[t,r,a]=e.split("T")[0].split("-");return r=`0${Math.max(1,Math.min(12,r))}`.slice(-2),a=`0${Math.max(1,Math.min(31,a))}`.slice(-2),`${t}-${r}-${a}`}function wi(e){if(e.includes(" "))return new Date(e).toISOString().substr(0,10);let[t,r]=e.split("T"),[a,l,f]=t.split("-"),[c,E,C]=r.substr(0,8).split(":");return l=`0${Math.max(1,Math.min(12,l))}`.slice(-2),f=`0${Math.max(1,Math.min(31,f))}`.slice(-2),c=`0${Math.max(1,Math.min(23,c))}`.slice(-2),E=`0${Math.max(1,Math.min(59,E))}`.slice(-2),C=`0${Math.max(1,Math.min(59,C))}`.slice(-2),`${a}-${l}-${f}T${c}:${E}:${C}.000Z`}function Si(e,t,r){let a={};switch(e||t.type){case"integer":case"number":if(typeof t.minimum!="undefined"&&(a.minimum=t.minimum),typeof t.maximum!="undefined"&&(a.maximum=t.maximum),t.enum){let f=Math.max(a.minimum||0,0),c=Math.min(a.maximum||1/0,1/0);t.exclusiveMinimum&&f===t.minimum&&(f+=t.multipleOf||1),t.exclusiveMaximum&&c===t.maximum&&(c-=t.multipleOf||1),(f||c!==1/0)&&(t.enum=t.enum.filter(E=>E>=f&&E<=c))}break;case"string":{a.minLength=z("minLength")||0,a.maxLength=z("maxLength")||Number.MAX_SAFE_INTEGER,typeof t.minLength!="undefined"&&(a.minLength=Math.max(a.minLength,t.minLength)),typeof t.maxLength!="undefined"&&(a.maxLength=Math.min(a.maxLength,t.maxLength));break}default:break}let l=r(a);if(l==null)return null;switch(e||t.type){case"number":l=wt(l)?parseFloat(l):l;break;case"integer":l=wt(l)?parseInt(l,10):l;break;case"boolean":l=!!l;break;case"string":{if(je(l))return l;l=String(l);let f=Math.max(a.minLength||0,0),c=Math.min(a.maxLength||1/0,1/0),E,C=0;for(;l.length<f;)if(E=l,t.pattern?l+=Q.randexp(t.pattern):l+=`${Q.pick([" ","/","_","-","+","=","@","^"])}${l}`,l===E){if(C+=1,C===3)break}else C=0;switch(l.length>c&&(l=l.substr(0,c)),t.format){case"date-time":case"datetime":l=new Date(wi(l)).toISOString().replace(/([0-9])0+Z$/,"$1Z");break;case"full-date":case"date":l=new Date(Tr(l)).toISOString().substr(0,10);break;case"time":l=new Date(`1969-01-01 ${l}`).toISOString().substr(11);break;default:break}break}default:break}return l}function ze(e,t){return Object.keys(t).forEach(r=>{typeof t[r]!="object"||t[r]===null?e[r]=t[r]:Array.isArray(t[r])?(e[r]=e[r]||[],t[r].forEach((a,l)=>{e.type==="array"&&t.type==="array"?e[r][l]=ze(e[r][l]||{},a,!0):Array.isArray(e[r])&&e[r].indexOf(a)===-1&&e[r].push(a)})):typeof e[r]!="object"||e[r]===null||Array.isArray(e[r])?e[r]=ze({},t[r]):e[r]=ze(e[r],t[r])}),e}function St(e,t=new Map){if(!e||typeof e!="object")return e;if(t.has(e))return t.get(e);if(Array.isArray(e)){let a=[];return t.set(e,a),a.push(...e.map(l=>St(l,t))),a}let r={};return t.set(e,r),Object.keys(e).reduce((a,l)=>(a[l]=St(e[l],t),a),r)}function Ei(e){let t=JSON.stringify(e),r=JSON.stringify(e,null,2);return t.length>400?`${r.substr(0,400)}...`:r}function Pr(){return Q.pick([!1,!0,null,-1,NaN,Math.PI,1/0,void 0,[],{},Math.random(),Math.random().toString(36).substr(2)])}function vi(e,t){if(e.enum)return e.enum.includes(t);if(e.const)return e.const===t}function Oi(e,t){let r=ze({},t);if(typeof e.minimum!="undefined"&&(r.maximum=e.minimum,r.exclusiveMaximum=!0),typeof e.maximum!="undefined"&&(r.minimum=e.maximum>r.maximum?0:e.maximum,r.exclusiveMinimum=!0),typeof e.minLength!="undefined"&&(r.maxLength=e.minLength),typeof e.maxLength!="undefined"&&(r.minLength=e.maxLength>r.maxLength?0:e.maxLength),e.type)r.type=Q.pick(Ve.SCALAR_TYPES.filter(a=>(Array.isArray(e.type)?e.type:[e.type]).every(f=>a==="number"||a==="integer"?f!=="number"&&f!=="integer":a!==f)));else if(e.enum){let a;do a=Pr();while(e.enum.indexOf(a)!==-1);r.enum=[a]}return e.required&&r.properties&&e.required.forEach(a=>{delete r.properties[a]}),r}function Vt(e,t){let r=t.minimum!==void 0,a=t.maximum!==void 0;return(r||a)&&(!r||e>=t.minimum)&&(!a||e<=t.maximum)}function Ai(e,t){return!t.every(r=>Vt(e,r))}function bi(e,t){return t.reduce((a,l)=>a+(Vt(e,l)?1:0),0)===1}function Ti(e){return["enum","const","default","examples","required","definitions","items","properties"].includes(e)}function Pi(e,t){return Object.keys(e).filter(r=>!t.includes(r)).reduce((r,a)=>(Array.isArray(e[a])?r[a]=e[a].slice():r[a]=e[a]instanceof Object?ze({},e[a]):e[a],r),{})}function Rr(e,t){return Array.isArray(e)?e.map(r=>Rr(r,t)):(typeof e=="string"&&(e=e.replace(/#\{([\w.-]+)\}/g,(r,a)=>t[a])),e)}function Yt(e){return Object.prototype.toString.call(e)==="[object Object]"&&!Object.keys(e).length}function _r(e,t){t=t.items||t;let r=z("alwaysFakeOptionals"),a=Array.isArray(t.required)&&t.required.includes(e)||r,l=typeof t.thunk=="function"||t.additionalProperties&&typeof t.additionalProperties.thunk=="function";return!a&&!l}function Ht(e,t,r=!1){if(!e||typeof e!="object")return e;if(Array.isArray(e))return e.map(a=>Ht(a,t,!0)).filter(a=>typeof a!="undefined");if(Object.keys(e).forEach(a=>{if(Yt(e[a]))_r(a,t)&&delete e[a];else{let l=t;t&&t.properties&&t.properties[a]&&(l=t.properties[a]);let f=Ht(e[a],l);Yt(f)||(e[a]=f)}typeof e[a]=="undefined"&&delete e[a]}),!(!Object.keys(e).length&&r))return e}function Ri(e){return(t,r,a,l)=>{let f=t,c=[];typeof t=="object"&&(f=Object.keys(t)[0],Array.isArray(t[f])?c=t[f]:c.push(t[f]));let E=f.split("."),C=e();for(;E.length>1;)C=C[E.shift()];return t=typeof C=="object"?C[E[0]]:C,typeof t=="function"&&(t=t.apply(C,c.map(S=>ue.template(S,l)))),Object.prototype.toString.call(t)==="[object Object]"&&Object.keys(t).forEach(S=>{if(typeof t[S]=="function")throw new Error(`Cannot resolve value for '${a}: ${f}', given: ${t}`)}),t}}function _i(e,t){if(typeof e=="undefined")return et.list();if(typeof e=="string")if(typeof t=="function")et.register(e,t);else if(t===null||t===!1)et.unregister(e);else return et.get(e);else et.registerMany(e)}function Ii(e,t,r){return Object.keys(e).filter(a=>{let l=sn.indexOf(t)>-1;return r.indexOf(a)>-1&&!l}).length>0}function Mi(e,t){let r=Object.keys(lt);for(let a=0;a<r.length;a+=1){let l=r[a],f=t[t.length-1];if(Ii(e,f,lt[l]))return l}}function ki(){return z("random")()>.5}function Ni(){return null}function Li(e,t,r,a,l,f){let c=[],E=[];function C(D){let A=JSON.stringify(D.value);return E.indexOf(A)===-1?(E.push(A),c.push(D),!0):!1}t.forEach(C);let S=100;for(;c.length!==t.length&&(C(f(r.items||a,e,l))||(S-=1),!!S););return c}function Ci(e,t,r,a){let l=[];if(!(e.items||e.additionalItems)){if(ue.hasProperties(e,"minItems","maxItems","uniqueItems")&&(e.minItems!==0||e.maxItems!==0))throw new Ot(`missing items for ${ue.short(e)}`,t);return l}if(Array.isArray(e.items))return e.items.map((U,ie)=>{let G=t.concat(["items",ie]);return a(U,G,r)});let f=e.minItems,c=e.maxItems,E=z("minItems"),C=z("maxItems");E&&(f=typeof f=="undefined"?E:Math.min(E,f)),C&&(c=typeof c=="undefined"?C:Math.min(C,c),c&&c>C&&(c=C),f&&f>C&&(f=c));let S=z("alwaysFakeOptionals")===!0?1:z("optionalsProbability"),D=z("alwaysFakeOptionals")||z("fixedProbabilities")||!1,A=Q.number(f,c,1,5);S!==null&&(A=Math.max(D?Math.round((c||A)*S):Math.abs(Q.number(f,c)*S),f||0));let Y=typeof e.additionalItems=="object"?e.additionalItems:{};for(let U=l.length;U<A;U+=1){let ie=t.concat(["items",U]),G=a(e.items||Y,ie,r);l.push(G)}if(e.contains&&A>0){let U=Q.number(0,A-1);l[U]=a(e.contains,t.concat(["items",U]),r)}return e.uniqueItems?Li(t.concat(["items"]),l,e,Y,r,a):l}function $i(e){let t=typeof e.minimum=="undefined"||e.minimum===-Number.MAX_VALUE?Ve.MIN_INTEGER:e.minimum,r=typeof e.maximum=="undefined"||e.maximum===Number.MAX_VALUE?Ve.MAX_INTEGER:e.maximum,a=e.multipleOf,l=a&&String(a).match(/e-(\d)|\.(\d+)$/);if(l){let f=(Math.random()*Q.number(0,10)+1)*a,c=l[1]||l[2].length,E=parseFloat(f.toFixed(c)),C=Q.number(t,r-1);return String(E).includes(".")?C+E:(C+E).toExponential()}if(a&&(r=Math.floor(r/a)*a,t=Math.ceil(t/a)*a),e.exclusiveMinimum&&t===e.minimum&&(t+=a||1),e.exclusiveMaximum&&r===e.maximum&&(r-=a||1),t>r)return NaN;if(a){let f=Q.number(Math.floor(t/a),Math.floor(r/a))*a;for(;f<t;)f+=a;return f}return Q.number(t,r,void 0,void 0,e.type!=="integer")}function xi(e){return Math.floor(or({...e}))}function Di(e){return Q.shuffle(mn).slice(0,e)}function Fi(e,t,r,a){let l={},f=e.properties||{},c=e.patternProperties||{},E=typeof e.required=="boolean"?[]:(e.required||[]).slice(),C=e.additionalProperties!==!1,S=Object.keys(f),D=Object.keys(c),A=S.concat(D).reduce((W,p)=>(E.indexOf(p)===-1&&W.push(p),W),[]),Y=E.concat(A),U=C&&e.additionalProperties===!0?bt:e.additionalProperties;if(!C&&S.length===0&&D.length===0&&ue.hasProperties(e,"minProperties","maxProperties","dependencies","required"))return null;if(z("requiredOnly")===!0)return E.forEach(W=>{f[W]&&(l[W]=f[W])}),a(l,t.concat(["properties"]),r,e);let ie=z("alwaysFakeOptionals")===!0?1:z("optionalsProbability"),G=z("alwaysFakeOptionals")||z("fixedProbabilities")||!1,X=z("ignoreProperties")||[],fe=z("reuseProperties"),de=z("fillProperties"),F=e.maxProperties||Y.length+(C?Q.number(1,5):0),g=Math.max(e.minProperties||0,E.length),w=Math.max(0,Y.length-g);Y.length===1&&!E.length&&(g=Math.max(Q.number(de?1:0,F),g)),ie!==null&&(G===!0?w=Math.round(g-E.length+ie*(Y.length-g)):w=Q.number(g-E.length,ie*(Y.length-g)));let T=Q.shuffle(A).slice(0,w),_=A.filter(W=>T.indexOf(W)!==-1),N=ie!==null||E.length===F?F:Q.number(0,F),b=E.concat(Q.shuffle(_).slice(0,N)).slice(0,F),I=[],k=[];if(e.dependencies&&(Object.keys(e.dependencies).forEach(W=>{let p=e.dependencies[W];if(b.indexOf(W)!==-1)if(Array.isArray(p))p.forEach(M=>{b.indexOf(M)===-1&&b.push(M)});else if(Array.isArray(p.oneOf||p.anyOf)){let M=p.oneOf||p.anyOf;k.push({prop:W,values:M})}else I.push(p)}),I.length))return delete e.dependencies,a({allOf:I.concat(e)},t.concat(["properties"]),r,e);let B=[],H=[];b.forEach(W=>{if(f[W]&&["{}","true"].includes(JSON.stringify(f[W].not)))return;for(let M=0;M<X.length;M+=1)if(X[M]instanceof RegExp&&X[M].test(W)||typeof X[M]=="string"&&X[M]===W||typeof X[M]=="function"&&X[M](f[W],W)){B.push(W);return}U===!1&&E.indexOf(W)!==-1&&(l[W]=f[W]),f[W]&&(l[W]=f[W]);let p;if(D.forEach(M=>{W.match(new RegExp(M))&&(p=!0,l[W]?ue.merge(l[W],c[M]):l[Q.randexp(W)]=c[M])}),!p){let M=c[W]||U;M&&U!==!1?l[c[W]?Q.randexp(W):W]=f[W]||M:H.push(W)}});let Z=Object.keys(l).length+(de?0:B.length),we=W=>Q.randexp(`_?[_a-f\\d]{1,3}${W?"\\$?":""}`);function Se(W){let p;do{if(!W.length)break;p=W.shift()}while(l[p]);return p}let Oe=g;if(C&&!E.length&&(Oe=Math.max(ie===null||U?Q.number(de?1:0,F):0,g)),!_.length&&!w&&C&&G===!0&&de){let W=Q.number(0,F);for(let p=0;p<W;p+=1)l[At(1)+we(W[p])]=U||bt}for(;de&&!(!(D.length||C)||Z>=Oe);){if(C)if(fe&&S.length-Z>Oe){let W=0,p;do{if(W+=1,W>1e3)break;p=Se(E)||Q.pick(S)}while(typeof l[p]!="undefined");typeof l[p]=="undefined"&&(l[p]=f[p],Z+=1)}else if(D.length&&!U){let W=Q.pick(D),p=Q.randexp(W);l[p]||(l[p]=c[W],Z+=1)}else{let W=Se(E)||At(1)+we();l[W]||(l[W]=U||bt,Z+=1)}for(let W=0;Z<g&&W<D.length;W+=1){let p=D[W],M=Q.randexp(p);l[M]||(l[M]=c[p],Z+=1)}}if(E.length===0&&(!C||ie===!1)){let W=Q.number(g,F);for(;Z<W;){let p=Se(S);p&&(l[p]=f[p]),Z+=1}}let Te=l;if(z("sortProperties")!==null){let W=Object.keys(f);Te=Object.keys(l).sort((M,q)=>z("sortProperties")?M.localeCompare(q):W.indexOf(M)-W.indexOf(q)).reduce((M,q)=>(M[q]=l[q],M),{})}let _e=a(Te,t.concat(["properties"]),r,e);return k.forEach(W=>{for(let p of W.values)if(ue.hasValue(p.properties[W.prop],_e.value[W.prop])){Object.keys(p.properties).forEach(M=>{M!==W.prop&&ue.merge(_e.value,a(p.properties,t.concat(["properties"]),r,e).value)});break}}),_e}function Ir(){let e=Q.number(1,5);return At(e).join(" ")}function Wi(e=0,t=140){let r=Math.max(0,e),a=Q.number(r,t),l=Ir();for(;l.length<r;)l+=Ir();return l.length>a&&(l=l.substr(0,a)),l}function Ui(){return[0,0,0,0].map(()=>Q.number(0,255)).join(".")}function ji(){return Q.date().toISOString()}function Bi(){return Tt().slice(0,10)}function Vi(){return Tt().slice(11)}function Yi(e){return Q.randexp(xe[e]).replace(vn,(t,r)=>Q.randexp(xe[r]))}function Hi(e,t){let r=sr(e.format);if(typeof r=="function")return r(e);switch(e.format){case"date-time":case"datetime":return Tt();case"date":return wn();case"time":return Sn();case"ipv4":return yn();case"regex":return".+?";case"email":case"hostname":case"ipv6":case"uri":case"uri-reference":case"iri":case"iri-reference":case"idn-email":case"idn-hostname":case"json-pointer":case"slug":case"uri-template":case"uuid":case"duration":return On(e.format);default:if(typeof r=="undefined"){if(z("failOnInvalidFormat"))throw new Error(`unknown registry key ${ue.short(e.format)}`);return t()}throw new Error(`unsupported format '${e.format}'`)}}function qi(e){return ue.typecast("string",e,r=>e.format?Hi(e,()=>ar(r.minLength,r.maxLength)):e.pattern?Q.randexp(e.pattern):ar(r.minLength,r.maxLength))}function Ki({$comment:e,title:t,description:r}){return Object.entries({comment:e,title:t,description:r}).filter(([,a])=>a).reduce((a,[l,f])=>(a[l]=f,a),{})}function Xe(e,t,r,a){if(e=r(e,null,t),e&&(e.oneOf||e.anyOf||e.allOf)&&(e=r(e,null,t)),!e)throw new Error(`Cannot traverse at '${t.join(".")}', given '${JSON.stringify(a)}'`);let l={...Ki(e),schemaPath:t};if(t[t.length-1]!=="properties"){if(z("useExamplesValue")&&Array.isArray(e.examples)){let S=e.examples.concat("default"in e?[e.default]:[]);return{value:ue.typecast(null,e,()=>Q.pick(S)),context:l}}if(z("useExamplesValue")&&typeof e.example!="undefined")return{value:ue.typecast(null,e,()=>e.example),context:l};if(z("useDefaultValue")&&"default"in e&&(e.default!==""||!z("replaceEmptyByRandomValue")))return{value:e.default,context:l};if("template"in e)return{value:ue.template(e.template,a),context:l};if("const"in e)return{value:e.const,context:l}}if(e.not&&typeof e.not=="object"&&(e=ue.notValue(e.not,ue.omitProps(e,["not"])),e.type&&e.type==="object")){let{value:S,context:D}=Xe(e,t.concat(["not"]),r,a);return{value:ue.clean(S,e,!1),context:{...l,items:D}}}if(typeof e.thunk=="function"){let{value:S,context:D}=Xe(e.thunk(a),t,r);return{value:S,context:{...l,items:D}}}if(e.jsonPath)return{value:e,context:l};let f=e.type;if(Array.isArray(f)?f=Q.pick(f):typeof f=="undefined"&&(f=on(e,t)||f,f&&(e.type=f)),typeof e.generate=="function"){let S=ue.typecast(null,e,()=>e.generate(a,t)),D=S===null?"null":typeof S;if(D===f||D==="number"&&f==="integer"||Array.isArray(S)&&f==="array")return{value:S,context:l}}if(typeof e.pattern=="string")return{value:ue.typecast("string",e,()=>Q.randexp(e.pattern)),context:l};if(Array.isArray(e.enum))return{value:ue.typecast(null,e,()=>Q.pick(e.enum)),context:l};if(typeof f=="string")if(ut[f])try{let S=ut[f](e,t,r,Xe);return f==="array"?{value:S.map(({value:D})=>D),context:{...l,items:S.map(Array.isArray(e.items)?({context:D})=>D:({context:D})=>({...D,schemaPath:D.schemaPath.slice(0,-1)}))}}:f==="object"?S!==null?{value:S.value,context:{...l,items:S.context}}:{value:{},context:l}:{value:S,context:l}}catch(S){throw typeof S.path=="undefined"?new Ot(S.stack,t):S}else{if(z("failOnInvalidTypes"))throw new Ot(`unknown primitive ${ue.short(f)}`,t.concat(["type"]));{let S=z("defaultInvalidTypeProduct");return typeof S=="string"&&ut[S]?{value:ut[S](e,t,r,Xe),context:l}:{value:S,context:l}}}let c={},E={...l};Array.isArray(e)&&(c=[]);let C=z("pruneProperties")||[];return Object.keys(e).forEach(S=>{if(!C.includes(S)&&e[S]!==null)if(typeof e[S]=="object"&&S!=="definitions"){let{value:D,context:A}=Xe(e[S],t.concat([S]),r,c);c[S]=ue.clean(D,e[S],!1),E[S]=A,c[S]===null&&z("omitNulls")&&(delete c[S],delete E[S])}else c[S]=e[S]}),{value:c,context:E}}function Ji(e){return Array.isArray(e)?Q.pick(e):e}function Gi(e,t){if(!Array.isArray(e))return e;let r=t?e.pop():e.shift();return t?e.unshift(r):e.push(r),r}function qt(e,t,r,a){if(!e||typeof e!="object")return e;if(r||(r={}),t||(t=e),Array.isArray(e))return e.map(l=>qt(l,t,r,a));if(e.jsonPath){let{JSONPath:l}=er(),f=typeof e.jsonPath!="object"?{path:e.jsonPath}:e.jsonPath;f.group=e.group||f.group||a,f.cycle=e.cycle||f.cycle||!1,f.reverse=e.reverse||f.reverse||!1,f.count=e.count||f.count||1;let c=`${f.group}__${f.path}`;return r[c]||(f.count>1?r[c]=l(f.path,t).slice(0,f.count):r[c]=l(f.path,t)),f.cycle||f.reverse?Gi(r[c],f.reverse):Ji(r[c])}return Object.keys(e).forEach(l=>{e[l]=qt(e[l],t,r,l)}),e}function Qi(e,t,r,a){if(Object.prototype.toString.call(t)!=="[object Object]")throw new Error(`Invalid input, expecting object but given ${typeof t}`);let l=z("refDepthMin")||0,f=z("refDepthMax")||3;try{let{resolveSchema:c}=Rn({refs:e,schema:t,container:r,synchronous:a,refDepthMin:l,refDepthMax:f}),E=Tn(ue.clone(t),[],c);return z("resolveJsonPath")?{value:qt(E.value),context:E.context}:E}catch(c){throw c.path?new Error(`${c.message} in /${c.path.join("/")}`):c}}function Zi(e){return e.value}function zi(e,t){return t.reduce((r,a)=>a in r?r[a]:{},e)}function Kt(e,t,r,a=r){let{title:l,description:f,comment:c}=zi(e,t),E=[];z("renderTitle")&&l&&E.push(` ${l}`,""),z("renderDescription")&&f&&E.push(` ${f}`),z("renderComment")&&c&&E.push(` ${c}`),r.commentBefore=E.join(`
`),a instanceof _n?a.items.forEach(C=>{Kt(e,[...t,"items",C.key.value],C.key,C.value)}):a instanceof In&&a.items.forEach((C,S)=>{Kt(e,[...t,"items",S],C)})}function Xi({value:e,context:t}){let r=ct.createNode(e);Kt(t,[],r);let a=new ct.Document;return a.contents=r,a.toString()}function Mr(){He.define("autoIncrement",function(t,r){if(!this.offset){let a=r.minimum||1,l=a+Ve.MAX_NUMBER,f=t.initialOffset||r.initialOffset;this.offset=f||Q.number(a,l)}return t?this.offset++:r}),He.define("sequentialDate",function(t,r){if(this.now||(this.now=Q.date()),t){if(r=this.now.toISOString(),t=t===!0?"days":t,["seconds","minutes","hours","days","weeks","months","years"].indexOf(t)===-1)throw new Error(`Unsupported increment by ${ue.short(t)}`);this.now.setTime(this.now.getTime()+Q.date(t))}return r})}function kr(e,t){let r={};Array.isArray(e)?e.forEach(l=>{r[l.$id||l.id]=l}):r=e||{};function a(l){if(!l||typeof l!="object")return;if(Array.isArray(l))return l.forEach(a);let f=l.$id||l.id;typeof f=="string"&&!r[f]&&(r[f]=l),Object.keys(l).forEach(c=>{a(l[c])})}return a(e),a(t),r}var Nr,Jt,Lr,Gt,Cr,$r,Ce,xr,Qt,st,Zt,Dr,Fr,Wr,Ur,jr,ot,Et,zt,Br,Vr,Xt,er,Yr,Hr,tr,le,rr,qr,Kr,at,z,nr,ir,Jr,Gr,Qr,Zr,zr,Xr,Ve,vt,Q,en,ue,tn,rn,et,sr,nn,Ot,lt,sn,on,an,ln,un,cn,fn,pn,dn,or,hn,mn,At,bt,gn,ar,yn,Tt,wn,Sn,lr,Pt,En,xe,vn,On,An,bn,ut,Tn,Pn,Rn,ur,cr,Ie,es,ts,rs,ns,is,ss,os,as,ls,us,cs,fs,_n,In,ct,He,ye,Mn,kn,ps=P({"src/shared.js"(){Nr=Object.create,Jt=Object.defineProperty,Lr=Object.getOwnPropertyDescriptor,Gt=Object.getOwnPropertyNames,Cr=Object.getPrototypeOf,$r=Object.prototype.hasOwnProperty,Ce=(e,t)=>function(){return t||(0,e[Gt(e)[0]])((t={exports:{}}).exports,t),t.exports},xr=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of Gt(t))!$r.call(e,l)&&l!==r&&Jt(e,l,{get:()=>t[l],enumerable:!(a=Lr(t,l))||a.enumerable});return e},Qt=(e,t,r)=>(r=e!=null?Nr(Cr(e)):{},xr(t||!e||!e.__esModule?Jt(r,"default",{value:e,enumerable:!0}):r,e)),st=Ce({"node_modules/ret/lib/types.js"(e,t){t.exports={ROOT:0,GROUP:1,POSITION:2,SET:3,RANGE:4,REPETITION:5,REFERENCE:6,CHAR:7}}}),Zt=Ce({"node_modules/ret/lib/sets.js"(e){var t=st(),r=()=>[{type:t.RANGE,from:48,to:57}],a=()=>[{type:t.CHAR,value:95},{type:t.RANGE,from:97,to:122},{type:t.RANGE,from:65,to:90}].concat(r()),l=()=>[{type:t.CHAR,value:9},{type:t.CHAR,value:10},{type:t.CHAR,value:11},{type:t.CHAR,value:12},{type:t.CHAR,value:13},{type:t.CHAR,value:32},{type:t.CHAR,value:160},{type:t.CHAR,value:5760},{type:t.RANGE,from:8192,to:8202},{type:t.CHAR,value:8232},{type:t.CHAR,value:8233},{type:t.CHAR,value:8239},{type:t.CHAR,value:8287},{type:t.CHAR,value:12288},{type:t.CHAR,value:65279}],f=()=>[{type:t.CHAR,value:10},{type:t.CHAR,value:13},{type:t.CHAR,value:8232},{type:t.CHAR,value:8233}];e.words=()=>({type:t.SET,set:a(),not:!1}),e.notWords=()=>({type:t.SET,set:a(),not:!0}),e.ints=()=>({type:t.SET,set:r(),not:!1}),e.notInts=()=>({type:t.SET,set:r(),not:!0}),e.whitespace=()=>({type:t.SET,set:l(),not:!1}),e.notWhitespace=()=>({type:t.SET,set:l(),not:!0}),e.anyChar=()=>({type:t.SET,set:f(),not:!0})}}),Dr=Ce({"node_modules/ret/lib/util.js"(e){var t=st(),r=Zt(),a="@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?",l={0:0,t:9,n:10,v:11,f:12,r:13};e.strToChars=function(f){var c=/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z[\\\]^?])|([0tnvfr]))/g;return f=f.replace(c,function(E,C,S,D,A,Y,U,ie){if(S)return E;var G=C?8:D?parseInt(D,16):A?parseInt(A,16):Y?parseInt(Y,8):U?a.indexOf(U):l[ie],X=String.fromCharCode(G);return/[[\]{}^$.|?*+()]/.test(X)&&(X="\\"+X),X}),f},e.tokenizeClass=(f,c)=>{for(var E=[],C=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(?:\\)?([^\]]))|(\])|(?:\\)?([^])/g,S,D;(S=C.exec(f))!=null;)if(S[1])E.push(r.words());else if(S[2])E.push(r.ints());else if(S[3])E.push(r.whitespace());else if(S[4])E.push(r.notWords());else if(S[5])E.push(r.notInts());else if(S[6])E.push(r.notWhitespace());else if(S[7])E.push({type:t.RANGE,from:(S[8]||S[9]).charCodeAt(0),to:S[10].charCodeAt(0)});else if(D=S[12])E.push({type:t.CHAR,value:D.charCodeAt(0)});else return[E,C.lastIndex];e.error(c,"Unterminated character class")},e.error=(f,c)=>{throw new SyntaxError("Invalid regular expression: /"+f+"/: "+c)}}}),Fr=Ce({"node_modules/ret/lib/positions.js"(e){var t=st();e.wordBoundary=()=>({type:t.POSITION,value:"b"}),e.nonWordBoundary=()=>({type:t.POSITION,value:"B"}),e.begin=()=>({type:t.POSITION,value:"^"}),e.end=()=>({type:t.POSITION,value:"$"})}}),Wr=Ce({"node_modules/ret/lib/index.js"(e,t){var r=Dr(),a=st(),l=Zt(),f=Fr();t.exports=c=>{var E=0,C,S,D={type:a.ROOT,stack:[]},A=D,Y=D.stack,U=[],ie=_=>{r.error(c,`Nothing to repeat at column ${_-1}`)},G=r.strToChars(c);for(C=G.length;E<C;)switch(S=G[E++],S){case"\\":switch(S=G[E++],S){case"b":Y.push(f.wordBoundary());break;case"B":Y.push(f.nonWordBoundary());break;case"w":Y.push(l.words());break;case"W":Y.push(l.notWords());break;case"d":Y.push(l.ints());break;case"D":Y.push(l.notInts());break;case"s":Y.push(l.whitespace());break;case"S":Y.push(l.notWhitespace());break;default:/\d/.test(S)?Y.push({type:a.REFERENCE,value:parseInt(S,10)}):Y.push({type:a.CHAR,value:S.charCodeAt(0)})}break;case"^":Y.push(f.begin());break;case"$":Y.push(f.end());break;case"[":var X;G[E]==="^"?(X=!0,E++):X=!1;var fe=r.tokenizeClass(G.slice(E),c);E+=fe[1],Y.push({type:a.SET,set:fe[0],not:X});break;case".":Y.push(l.anyChar());break;case"(":var de={type:a.GROUP,stack:[],remember:!0};S=G[E],S==="?"&&(S=G[E+1],E+=2,S==="="?de.followedBy=!0:S==="!"?de.notFollowedBy=!0:S!==":"&&r.error(c,`Invalid group, character '${S}' after '?' at column ${E-1}`),de.remember=!1),Y.push(de),U.push(A),A=de,Y=de.stack;break;case")":U.length===0&&r.error(c,`Unmatched ) at column ${E-1}`),A=U.pop(),Y=A.options?A.options[A.options.length-1]:A.stack;break;case"|":A.options||(A.options=[A.stack],delete A.stack);var F=[];A.options.push(F),Y=F;break;case"{":var g=/^(\d+)(,(\d+)?)?\}/.exec(G.slice(E)),w,T;g!==null?(Y.length===0&&ie(E),w=parseInt(g[1],10),T=g[2]?g[3]?parseInt(g[3],10):1/0:w,E+=g[0].length,Y.push({type:a.REPETITION,min:w,max:T,value:Y.pop()})):Y.push({type:a.CHAR,value:123});break;case"?":Y.length===0&&ie(E),Y.push({type:a.REPETITION,min:0,max:1,value:Y.pop()});break;case"+":Y.length===0&&ie(E),Y.push({type:a.REPETITION,min:1,max:1/0,value:Y.pop()});break;case"*":Y.length===0&&ie(E),Y.push({type:a.REPETITION,min:0,max:1/0,value:Y.pop()});break;default:Y.push({type:a.CHAR,value:S.charCodeAt(0)})}return U.length!==0&&r.error(c,"Unterminated group"),D},t.exports.types=a}}),Ur=Ce({"node_modules/drange/lib/index.js"(e,t){"use strict";var r=class rt{constructor(f,c){this.low=f,this.high=c,this.length=1+c-f}overlaps(f){return!(this.high<f.low||this.low>f.high)}touches(f){return!(this.high+1<f.low||this.low-1>f.high)}add(f){return new rt(Math.min(this.low,f.low),Math.max(this.high,f.high))}subtract(f){return f.low<=this.low&&f.high>=this.high?[]:f.low>this.low&&f.high<this.high?[new rt(this.low,f.low-1),new rt(f.high+1,this.high)]:f.low<=this.low?[new rt(f.high+1,this.high)]:[new rt(this.low,f.low-1)]}toString(){return this.low==this.high?this.low.toString():this.low+"-"+this.high}},a=class dt{constructor(f,c){this.ranges=[],this.length=0,f!=null&&this.add(f,c)}_update_length(){this.length=this.ranges.reduce((f,c)=>f+c.length,0)}add(f,c){var E=C=>{for(var S=0;S<this.ranges.length&&!C.touches(this.ranges[S]);)S++;for(var D=this.ranges.slice(0,S);S<this.ranges.length&&C.touches(this.ranges[S]);)C=C.add(this.ranges[S]),S++;D.push(C),this.ranges=D.concat(this.ranges.slice(S)),this._update_length()};return f instanceof dt?f.ranges.forEach(E):(c==null&&(c=f),E(new r(f,c))),this}subtract(f,c){var E=C=>{for(var S=0;S<this.ranges.length&&!C.overlaps(this.ranges[S]);)S++;for(var D=this.ranges.slice(0,S);S<this.ranges.length&&C.overlaps(this.ranges[S]);)D=D.concat(this.ranges[S].subtract(C)),S++;this.ranges=D.concat(this.ranges.slice(S)),this._update_length()};return f instanceof dt?f.ranges.forEach(E):(c==null&&(c=f),E(new r(f,c))),this}intersect(f,c){var E=[],C=S=>{for(var D=0;D<this.ranges.length&&!S.overlaps(this.ranges[D]);)D++;for(;D<this.ranges.length&&S.overlaps(this.ranges[D]);){var A=Math.max(this.ranges[D].low,S.low),Y=Math.min(this.ranges[D].high,S.high);E.push(new r(A,Y)),D++}};return f instanceof dt?f.ranges.forEach(C):(c==null&&(c=f),C(new r(f,c))),this.ranges=E,this._update_length(),this}index(f){for(var c=0;c<this.ranges.length&&this.ranges[c].length<=f;)f-=this.ranges[c].length,c++;return this.ranges[c].low+f}toString(){return"[ "+this.ranges.join(", ")+" ]"}clone(){return new dt(this)}numbers(){return this.ranges.reduce((f,c)=>{for(var E=c.low;E<=c.high;)f.push(E),E++;return f},[])}subranges(){return this.ranges.map(f=>({low:f.low,high:f.high,length:1+f.high-f.low}))}};t.exports=a}}),jr=Ce({"node_modules/randexp/lib/randexp.js"(e,t){var r=Wr(),a=Ur(),l=r.types;t.exports=class ht{constructor(c,E){if(this._setDefaults(c),c instanceof RegExp)this.ignoreCase=c.ignoreCase,this.multiline=c.multiline,c=c.source;else if(typeof c=="string")this.ignoreCase=E&&E.indexOf("i")!==-1,this.multiline=E&&E.indexOf("m")!==-1;else throw new Error("Expected a regexp or string");this.tokens=r(c)}_setDefaults(c){this.max=c.max!=null?c.max:ht.prototype.max!=null?ht.prototype.max:100,this.defaultRange=c.defaultRange?c.defaultRange:this.defaultRange.clone(),c.randInt&&(this.randInt=c.randInt)}gen(){return this._gen(this.tokens,[])}_gen(c,E){var C,S,D,A,Y;switch(c.type){case l.ROOT:case l.GROUP:if(c.followedBy||c.notFollowedBy)return"";for(c.remember&&c.groupNumber===void 0&&(c.groupNumber=E.push(null)-1),C=c.options?this._randSelect(c.options):c.stack,S="",A=0,Y=C.length;A<Y;A++)S+=this._gen(C[A],E);return c.remember&&(E[c.groupNumber]=S),S;case l.POSITION:return"";case l.SET:var U=this._expand(c);return U.length?String.fromCharCode(this._randSelect(U)):"";case l.REPETITION:for(D=this.randInt(c.min,c.max===1/0?c.min+this.max:c.max),S="",A=0;A<D;A++)S+=this._gen(c.value,E);return S;case l.REFERENCE:return E[c.value-1]||"";case l.CHAR:var ie=this.ignoreCase&&this._randBool()?this._toOtherCase(c.value):c.value;return String.fromCharCode(ie)}}_toOtherCase(c){return c+(97<=c&&c<=122?-32:65<=c&&c<=90?32:0)}_randBool(){return!this.randInt(0,1)}_randSelect(c){return c instanceof a?c.index(this.randInt(0,c.length-1)):c[this.randInt(0,c.length-1)]}_expand(c){if(c.type===r.types.CHAR)return new a(c.value);if(c.type===r.types.RANGE)return new a(c.from,c.to);{let E=new a;for(let C=0;C<c.set.length;C++){let S=this._expand(c.set[C]);if(E.add(S),this.ignoreCase)for(let D=0;D<S.length;D++){let A=S.index(D),Y=this._toOtherCase(A);A!==Y&&E.add(Y)}}return c.not?this.defaultRange.clone().subtract(E):this.defaultRange.clone().intersect(E)}}randInt(c,E){return c+Math.floor(Math.random()*(1+E-c))}get defaultRange(){return this._range=this._range||new a(32,126)}set defaultRange(c){this._range=c}static randexp(c,E){var C;return typeof c=="string"&&(c=new RegExp(c,E)),c._randexp===void 0?(C=new ht(c,E),c._randexp=C):(C=c._randexp,C._setDefaults(c)),C.gen()}static sugar(){RegExp.prototype.gen=function(){return ht.randexp(this)}}}}}),ot=Ce({"node_modules/yaml/dist/PlainValue-ec8e588e.js"(e){"use strict";var t={ANCHOR:"&",COMMENT:"#",TAG:"!",DIRECTIVES_END:"-",DOCUMENT_END:"."},r={ALIAS:"ALIAS",BLANK_LINE:"BLANK_LINE",BLOCK_FOLDED:"BLOCK_FOLDED",BLOCK_LITERAL:"BLOCK_LITERAL",COMMENT:"COMMENT",DIRECTIVE:"DIRECTIVE",DOCUMENT:"DOCUMENT",FLOW_MAP:"FLOW_MAP",FLOW_SEQ:"FLOW_SEQ",MAP:"MAP",MAP_KEY:"MAP_KEY",MAP_VALUE:"MAP_VALUE",PLAIN:"PLAIN",QUOTE_DOUBLE:"QUOTE_DOUBLE",QUOTE_SINGLE:"QUOTE_SINGLE",SEQ:"SEQ",SEQ_ITEM:"SEQ_ITEM"},a="tag:yaml.org,2002:",l={MAP:"tag:yaml.org,2002:map",SEQ:"tag:yaml.org,2002:seq",STR:"tag:yaml.org,2002:str"};function f(F){let g=[0],w=F.indexOf(`
`);for(;w!==-1;)w+=1,g.push(w),w=F.indexOf(`
`,w);return g}function c(F){let g,w;return typeof F=="string"?(g=f(F),w=F):(Array.isArray(F)&&(F=F[0]),F&&F.context&&(F.lineStarts||(F.lineStarts=f(F.context.src)),g=F.lineStarts,w=F.context.src)),{lineStarts:g,src:w}}function E(F,g){if(typeof F!="number"||F<0)return null;let{lineStarts:w,src:T}=c(g);if(!w||!T||F>T.length)return null;for(let N=0;N<w.length;++N){let b=w[N];if(F<b)return{line:N,col:F-w[N-1]+1};if(F===b)return{line:N+1,col:1}}let _=w.length;return{line:_,col:F-w[_-1]+1}}function C(F,g){let{lineStarts:w,src:T}=c(g);if(!w||!(F>=1)||F>w.length)return null;let _=w[F-1],N=w[F];for(;N&&N>_&&T[N-1]===`
`;)--N;return T.slice(_,N)}function S({start:F,end:g},w,T=80){let _=C(F.line,w);if(!_)return null;let{col:N}=F;if(_.length>T)if(N<=T-10)_=_.substr(0,T-1)+"\u2026";else{let H=Math.round(T/2);_.length>N+H&&(_=_.substr(0,N+H-1)+"\u2026"),N-=_.length-T,_="\u2026"+_.substr(1-T)}let b=1,I="";g&&(g.line===F.line&&N+(g.col-F.col)<=T+1?b=g.col-F.col:(b=Math.min(_.length+1,T)-N,I="\u2026"));let k=N>1?" ".repeat(N-1):"",B="^".repeat(b);return`${_}
${k}${B}${I}`}var D=class ai{static copy(g){return new ai(g.start,g.end)}constructor(g,w){this.start=g,this.end=w||g}isEmpty(){return typeof this.start!="number"||!this.end||this.end<=this.start}setOrigRange(g,w){let{start:T,end:_}=this;if(g.length===0||_<=g[0])return this.origStart=T,this.origEnd=_,w;let N=w;for(;N<g.length&&!(g[N]>T);)++N;this.origStart=T+N;let b=N;for(;N<g.length&&!(g[N]>=_);)++N;return this.origEnd=_+N,b}},A=class Je{static addStringTerminator(g,w,T){if(T[T.length-1]===`
`)return T;let _=Je.endOfWhiteSpace(g,w);return _>=g.length||g[_]===`
`?T+`
`:T}static atDocumentBoundary(g,w,T){let _=g[w];if(!_)return!0;let N=g[w-1];if(N&&N!==`
`)return!1;if(T){if(_!==T)return!1}else if(_!==t.DIRECTIVES_END&&_!==t.DOCUMENT_END)return!1;let b=g[w+1],I=g[w+2];if(b!==_||I!==_)return!1;let k=g[w+3];return!k||k===`
`||k==="	"||k===" "}static endOfIdentifier(g,w){let T=g[w],_=T==="<",N=_?[`
`,"	"," ",">"]:[`
`,"	"," ","[","]","{","}",","];for(;T&&N.indexOf(T)===-1;)T=g[w+=1];return _&&T===">"&&(w+=1),w}static endOfIndent(g,w){let T=g[w];for(;T===" ";)T=g[w+=1];return w}static endOfLine(g,w){let T=g[w];for(;T&&T!==`
`;)T=g[w+=1];return w}static endOfWhiteSpace(g,w){let T=g[w];for(;T==="	"||T===" ";)T=g[w+=1];return w}static startOfLine(g,w){let T=g[w-1];if(T===`
`)return w;for(;T&&T!==`
`;)T=g[w-=1];return w+1}static endOfBlockIndent(g,w,T){let _=Je.endOfIndent(g,T);if(_>T+w)return _;{let N=Je.endOfWhiteSpace(g,_),b=g[N];if(!b||b===`
`)return N}return null}static atBlank(g,w,T){let _=g[w];return _===`
`||_==="	"||_===" "||T&&!_}static nextNodeIsIndented(g,w,T){return!g||w<0?!1:w>0?!0:T&&g==="-"}static normalizeOffset(g,w){let T=g[w];return T?T!==`
`&&g[w-1]===`
`?w-1:Je.endOfWhiteSpace(g,w):w}static foldNewline(g,w,T){let _=0,N=!1,b="",I=g[w+1];for(;I===" "||I==="	"||I===`
`;){switch(I){case`
`:_=0,w+=1,b+=`
`;break;case"	":_<=T&&(N=!0),w=Je.endOfWhiteSpace(g,w+2)-1;break;case" ":_+=1,w+=1;break}I=g[w+1]}return b||(b=" "),I&&_<=T&&(N=!0),{fold:b,offset:w,error:N}}constructor(g,w,T){Object.defineProperty(this,"context",{value:T||null,writable:!0}),this.error=null,this.range=null,this.valueRange=null,this.props=w||[],this.type=g,this.value=null}getPropValue(g,w,T){if(!this.context)return null;let{src:_}=this.context,N=this.props[g];return N&&_[N.start]===w?_.slice(N.start+(T?1:0),N.end):null}get anchor(){for(let g=0;g<this.props.length;++g){let w=this.getPropValue(g,t.ANCHOR,!0);if(w!=null)return w}return null}get comment(){let g=[];for(let w=0;w<this.props.length;++w){let T=this.getPropValue(w,t.COMMENT,!0);T!=null&&g.push(T)}return g.length>0?g.join(`
`):null}commentHasRequiredWhitespace(g){let{src:w}=this.context;if(this.header&&g===this.header.end||!this.valueRange)return!1;let{end:T}=this.valueRange;return g!==T||Je.atBlank(w,T-1)}get hasComment(){if(this.context){let{src:g}=this.context;for(let w=0;w<this.props.length;++w)if(g[this.props[w].start]===t.COMMENT)return!0}return!1}get hasProps(){if(this.context){let{src:g}=this.context;for(let w=0;w<this.props.length;++w)if(g[this.props[w].start]!==t.COMMENT)return!0}return!1}get includesTrailingLines(){return!1}get jsonLike(){return[r.FLOW_MAP,r.FLOW_SEQ,r.QUOTE_DOUBLE,r.QUOTE_SINGLE].indexOf(this.type)!==-1}get rangeAsLinePos(){if(!this.range||!this.context)return;let g=E(this.range.start,this.context.root);if(!g)return;let w=E(this.range.end,this.context.root);return{start:g,end:w}}get rawValue(){if(!this.valueRange||!this.context)return null;let{start:g,end:w}=this.valueRange;return this.context.src.slice(g,w)}get tag(){for(let g=0;g<this.props.length;++g){let w=this.getPropValue(g,t.TAG,!1);if(w!=null){if(w[1]==="<")return{verbatim:w.slice(2,-1)};{let[T,_,N]=w.match(/^(.*!)([^!]*)$/);return{handle:_,suffix:N}}}}return null}get valueRangeContainsNewline(){if(!this.valueRange||!this.context)return!1;let{start:g,end:w}=this.valueRange,{src:T}=this.context;for(let _=g;_<w;++_)if(T[_]===`
`)return!0;return!1}parseComment(g){let{src:w}=this.context;if(w[g]===t.COMMENT){let T=Je.endOfLine(w,g+1),_=new D(g,T);return this.props.push(_),T}return g}setOrigRanges(g,w){return this.range&&(w=this.range.setOrigRange(g,w)),this.valueRange&&this.valueRange.setOrigRange(g,w),this.props.forEach(T=>T.setOrigRange(g,w)),w}toString(){let{context:{src:g},range:w,value:T}=this;if(T!=null)return T;let _=g.slice(w.start,w.end);return Je.addStringTerminator(g,w.end,_)}},Y=class extends Error{constructor(F,g,w){if(!w||!(g instanceof A))throw new Error(`Invalid arguments for new ${F}`);super(),this.name=F,this.message=w,this.source=g}makePretty(){if(!this.source)return;this.nodeType=this.source.type;let F=this.source.context&&this.source.context.root;if(typeof this.offset=="number"){this.range=new D(this.offset,this.offset+1);let g=F&&E(this.offset,F);if(g){let w={line:g.line,col:g.col+1};this.linePos={start:g,end:w}}delete this.offset}else this.range=this.source.range,this.linePos=this.source.rangeAsLinePos;if(this.linePos){let{line:g,col:w}=this.linePos.start;this.message+=` at line ${g}, column ${w}`;let T=F&&S(this.linePos,F);T&&(this.message+=`:

${T}
`)}delete this.source}},U=class extends Y{constructor(F,g){super("YAMLReferenceError",F,g)}},ie=class extends Y{constructor(F,g){super("YAMLSemanticError",F,g)}},G=class extends Y{constructor(F,g){super("YAMLSyntaxError",F,g)}},X=class extends Y{constructor(F,g){super("YAMLWarning",F,g)}};function fe(F,g,w){return g in F?Object.defineProperty(F,g,{value:w,enumerable:!0,configurable:!0,writable:!0}):F[g]=w,F}var de=class Er extends A{static endOfLine(g,w,T){let _=g[w],N=w;for(;_&&_!==`
`&&!(T&&(_==="["||_==="]"||_==="{"||_==="}"||_===","));){let b=g[N+1];if(_===":"&&(!b||b===`
`||b==="	"||b===" "||T&&b===",")||(_===" "||_==="	")&&b==="#")break;N+=1,_=b}return N}get strValue(){if(!this.valueRange||!this.context)return null;let{start:g,end:w}=this.valueRange,{src:T}=this.context,_=T[w-1];for(;g<w&&(_===`
`||_==="	"||_===" ");)_=T[--w-1];let N="";for(let I=g;I<w;++I){let k=T[I];if(k===`
`){let{fold:B,offset:H}=A.foldNewline(T,I,-1);N+=B,I=H}else if(k===" "||k==="	"){let B=I,H=T[I+1];for(;I<w&&(H===" "||H==="	");)I+=1,H=T[I+1];H!==`
`&&(N+=I>B?T.slice(B,I+1):k)}else N+=k}let b=T[g];switch(b){case"	":{let I="Plain value cannot start with a tab character";return{errors:[new ie(this,I)],str:N}}case"@":case"`":{let I=`Plain value cannot start with reserved character ${b}`;return{errors:[new ie(this,I)],str:N}}default:return N}}parseBlockValue(g){let{indent:w,inFlow:T,src:_}=this.context,N=g,b=g;for(let I=_[N];I===`
`&&!A.atDocumentBoundary(_,N+1);I=_[N]){let k=A.endOfBlockIndent(_,w,N+1);if(k===null||_[k]==="#")break;_[k]===`
`?N=k:(b=Er.endOfLine(_,k,T),N=b)}return this.valueRange.isEmpty()&&(this.valueRange.start=g),this.valueRange.end=b,b}parse(g,w){this.context=g;let{inFlow:T,src:_}=g,N=w,b=_[N];return b&&b!=="#"&&b!==`
`&&(N=Er.endOfLine(_,w,T)),this.valueRange=new D(w,N),N=A.endOfWhiteSpace(_,N),N=this.parseComment(N),(!this.hasComment||this.valueRange.isEmpty())&&(N=this.parseBlockValue(N)),N}};e.Char=t,e.Node=A,e.PlainValue=de,e.Range=D,e.Type=r,e.YAMLError=Y,e.YAMLReferenceError=U,e.YAMLSemanticError=ie,e.YAMLSyntaxError=G,e.YAMLWarning=X,e._defineProperty=fe,e.defaultTagPrefix=a,e.defaultTags=l}}),Et=Ce({"node_modules/yaml/dist/resolveSeq-d03cb037.js"(e){"use strict";var t=ot();function r(i,n,o){return o?`#${o.replace(/[\s\S]^/gm,`$&${n}#`)}
${n}${i}`:i}function a(i,n,o){return o?o.indexOf(`
`)===-1?`${i} #${o}`:`${i}
`+o.replace(/^/gm,`${n||""}#`):i}var l=class{};function f(i,n,o){if(Array.isArray(i))return i.map((u,h)=>f(u,String(h),o));if(i&&typeof i.toJSON=="function"){let u=o&&o.anchors&&o.anchors.get(i);u&&(o.onCreate=m=>{u.res=m,delete o.onCreate});let h=i.toJSON(n,o);return u&&o.onCreate&&o.onCreate(h),h}return(!o||!o.keep)&&typeof i=="bigint"?Number(i):i}var c=class extends l{constructor(i){super(),this.value=i}toJSON(i,n){return n&&n.keep?this.value:f(this.value,i,n)}toString(){return String(this.value)}};function E(i,n,o){let u=o;for(let h=n.length-1;h>=0;--h){let m=n[h];if(Number.isInteger(m)&&m>=0){let v=[];v[m]=u,u=v}else{let v={};Object.defineProperty(v,m,{value:u,writable:!0,enumerable:!0,configurable:!0}),u=v}}return i.createNode(u,!1)}var C=i=>i==null||typeof i=="object"&&i[Symbol.iterator]().next().done,S=class Ze extends l{constructor(n){super(),t._defineProperty(this,"items",[]),this.schema=n}addIn(n,o){if(C(n))this.add(o);else{let[u,...h]=n,m=this.get(u,!0);if(m instanceof Ze)m.addIn(h,o);else if(m===void 0&&this.schema)this.set(u,E(this.schema,h,o));else throw new Error(`Expected YAML collection at ${u}. Remaining path: ${h}`)}}deleteIn([n,...o]){if(o.length===0)return this.delete(n);let u=this.get(n,!0);if(u instanceof Ze)return u.deleteIn(o);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${o}`)}getIn([n,...o],u){let h=this.get(n,!0);return o.length===0?!u&&h instanceof c?h.value:h:h instanceof Ze?h.getIn(o,u):void 0}hasAllNullValues(){return this.items.every(n=>{if(!n||n.type!=="PAIR")return!1;let o=n.value;return o==null||o instanceof c&&o.value==null&&!o.commentBefore&&!o.comment&&!o.tag})}hasIn([n,...o]){if(o.length===0)return this.has(n);let u=this.get(n,!0);return u instanceof Ze?u.hasIn(o):!1}setIn([n,...o],u){if(o.length===0)this.set(n,u);else{let h=this.get(n,!0);if(h instanceof Ze)h.setIn(o,u);else if(h===void 0&&this.schema)this.set(n,E(this.schema,o,u));else throw new Error(`Expected YAML collection at ${n}. Remaining path: ${o}`)}}toJSON(){return null}toString(n,{blockItem:o,flowChars:u,isMap:h,itemIndent:m},v,O){let{indent:R,indentStep:L,stringify:V}=n,J=this.type===t.Type.FLOW_MAP||this.type===t.Type.FLOW_SEQ||n.inFlow;J&&(m+=L);let ge=h&&this.hasAllNullValues();n=Object.assign({},n,{allNullValues:ge,indent:m,inFlow:J,type:null});let re=!1,he=!1,ne=this.items.reduce((Pe,oe,Ee)=>{let ce;oe&&(!re&&oe.spaceBefore&&Pe.push({type:"comment",str:""}),oe.commentBefore&&oe.commentBefore.match(/^.*$/gm).forEach(Ps=>{Pe.push({type:"comment",str:`#${Ps}`})}),oe.comment&&(ce=oe.comment),J&&(!re&&oe.spaceBefore||oe.commentBefore||oe.comment||oe.key&&(oe.key.commentBefore||oe.key.comment)||oe.value&&(oe.value.commentBefore||oe.value.comment))&&(he=!0)),re=!1;let Me=V(oe,n,()=>ce=null,()=>re=!0);return J&&!he&&Me.includes(`
`)&&(he=!0),J&&Ee<this.items.length-1&&(Me+=","),Me=a(Me,m,ce),re&&(ce||J)&&(re=!1),Pe.push({type:"item",str:Me}),Pe},[]),pe;if(ne.length===0)pe=u.start+u.end;else if(J){let{start:Pe,end:oe}=u,Ee=ne.map(ce=>ce.str);if(he||Ee.reduce((ce,Me)=>ce+Me.length+2,2)>Ze.maxFlowStringSingleLineLength){pe=Pe;for(let ce of Ee)pe+=ce?`
${L}${R}${ce}`:`
`;pe+=`
${R}${oe}`}else pe=`${Pe} ${Ee.join(" ")} ${oe}`}else{let Pe=ne.map(o);pe=Pe.shift();for(let oe of Pe)pe+=oe?`
${R}${oe}`:`
`}return this.comment?(pe+=`
`+this.comment.replace(/^/gm,`${R}#`),v&&v()):re&&O&&O(),pe}};t._defineProperty(S,"maxFlowStringSingleLineLength",60);function D(i){let n=i instanceof c?i.value:i;return n&&typeof n=="string"&&(n=Number(n)),Number.isInteger(n)&&n>=0?n:null}var A=class extends S{add(i){this.items.push(i)}delete(i){let n=D(i);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(i,n){let o=D(i);if(typeof o!="number")return;let u=this.items[o];return!n&&u instanceof c?u.value:u}has(i){let n=D(i);return typeof n=="number"&&n<this.items.length}set(i,n){let o=D(i);if(typeof o!="number")throw new Error(`Expected a valid index, not ${i}.`);this.items[o]=n}toJSON(i,n){let o=[];n&&n.onCreate&&n.onCreate(o);let u=0;for(let h of this.items)o.push(f(h,String(u++),n));return o}toString(i,n,o){return i?super.toString(i,{blockItem:u=>u.type==="comment"?u.str:`- ${u.str}`,flowChars:{start:"[",end:"]"},isMap:!1,itemIndent:(i.indent||"")+"  "},n,o):JSON.stringify(this)}},Y=(i,n,o)=>n===null?"":typeof n!="object"?String(n):i instanceof l&&o&&o.doc?i.toString({anchors:Object.create(null),doc:o.doc,indent:"",indentStep:o.indentStep,inFlow:!0,inStringifyKey:!0,stringify:o.stringify}):JSON.stringify(n),U=class li extends l{constructor(n,o=null){super(),this.key=n,this.value=o,this.type=li.Type.PAIR}get commentBefore(){return this.key instanceof l?this.key.commentBefore:void 0}set commentBefore(n){if(this.key==null&&(this.key=new c(null)),this.key instanceof l)this.key.commentBefore=n;else{let o="Pair.commentBefore is an alias for Pair.key.commentBefore. To set it, the key must be a Node.";throw new Error(o)}}addToJSMap(n,o){let u=f(this.key,"",n);if(o instanceof Map){let h=f(this.value,u,n);o.set(u,h)}else if(o instanceof Set)o.add(u);else{let h=Y(this.key,u,n),m=f(this.value,h,n);h in o?Object.defineProperty(o,h,{value:m,writable:!0,enumerable:!0,configurable:!0}):o[h]=m}return o}toJSON(n,o){let u=o&&o.mapAsMap?new Map:{};return this.addToJSMap(o,u)}toString(n,o,u){if(!n||!n.doc)return JSON.stringify(this);let{indent:h,indentSeq:m,simpleKeys:v}=n.doc.options,{key:O,value:R}=this,L=O instanceof l&&O.comment;if(v){if(L)throw new Error("With simple keys, key nodes cannot have comments");if(O instanceof S){let Me="With simple keys, collection cannot be used as a key value";throw new Error(Me)}}let V=!v&&(!O||L||(O instanceof l?O instanceof S||O.type===t.Type.BLOCK_FOLDED||O.type===t.Type.BLOCK_LITERAL:typeof O=="object")),{doc:J,indent:ge,indentStep:re,stringify:he}=n;n=Object.assign({},n,{implicitKey:!V,indent:ge+re});let ne=!1,pe=he(O,n,()=>L=null,()=>ne=!0);if(pe=a(pe,n.indent,L),!V&&pe.length>1024){if(v)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");V=!0}if(n.allNullValues&&!v)return this.comment?(pe=a(pe,n.indent,this.comment),o&&o()):ne&&!L&&u&&u(),n.inFlow&&!V?pe:`? ${pe}`;pe=V?`? ${pe}
${ge}:`:`${pe}:`,this.comment&&(pe=a(pe,n.indent,this.comment),o&&o());let Pe="",oe=null;if(R instanceof l){if(R.spaceBefore&&(Pe=`
`),R.commentBefore){let Me=R.commentBefore.replace(/^/gm,`${n.indent}#`);Pe+=`
${Me}`}oe=R.comment}else R&&typeof R=="object"&&(R=J.schema.createNode(R,!0));n.implicitKey=!1,!V&&!this.comment&&R instanceof c&&(n.indentAtStart=pe.length+1),ne=!1,!m&&h>=2&&!n.inFlow&&!V&&R instanceof A&&R.type!==t.Type.FLOW_SEQ&&!R.tag&&!J.anchors.getName(R)&&(n.indent=n.indent.substr(2));let Ee=he(R,n,()=>oe=null,()=>ne=!0),ce=" ";return Pe||this.comment?ce=`${Pe}
${n.indent}`:!V&&R instanceof S?(!(Ee[0]==="["||Ee[0]==="{")||Ee.includes(`
`))&&(ce=`
${n.indent}`):Ee[0]===`
`&&(ce=""),ne&&!oe&&u&&u(),a(pe+ce+Ee,n.indent,oe)}};t._defineProperty(U,"Type",{PAIR:"PAIR",MERGE_PAIR:"MERGE_PAIR"});var ie=(i,n)=>{if(i instanceof G){let o=n.get(i.source);return o.count*o.aliasCount}else if(i instanceof S){let o=0;for(let u of i.items){let h=ie(u,n);h>o&&(o=h)}return o}else if(i instanceof U){let o=ie(i.key,n),u=ie(i.value,n);return Math.max(o,u)}return 1},G=class ui extends l{static stringify({range:n,source:o},{anchors:u,doc:h,implicitKey:m,inStringifyKey:v}){let O=Object.keys(u).find(L=>u[L]===o);if(!O&&v&&(O=h.anchors.getName(o)||h.anchors.newName()),O)return`*${O}${m?" ":""}`;let R=h.anchors.getName(o)?"Alias node must be after source node":"Source node not found for alias node";throw new Error(`${R} [${n}]`)}constructor(n){super(),this.source=n,this.type=t.Type.ALIAS}set tag(n){throw new Error("Alias nodes cannot have tags")}toJSON(n,o){if(!o)return f(this.source,n,o);let{anchors:u,maxAliasCount:h}=o,m=u.get(this.source);if(!m||m.res===void 0){let v="This should not happen: Alias anchor was not resolved?";throw this.cstNode?new t.YAMLReferenceError(this.cstNode,v):new ReferenceError(v)}if(h>=0&&(m.count+=1,m.aliasCount===0&&(m.aliasCount=ie(this.source,u)),m.count*m.aliasCount>h)){let v="Excessive alias count indicates a resource exhaustion attack";throw this.cstNode?new t.YAMLReferenceError(this.cstNode,v):new ReferenceError(v)}return m.res}toString(n){return ui.stringify(this,n)}};t._defineProperty(G,"default",!0);function X(i,n){let o=n instanceof c?n.value:n;for(let u of i)if(u instanceof U&&(u.key===n||u.key===o||u.key&&u.key.value===o))return u}var fe=class extends S{add(i,n){i?i instanceof U||(i=new U(i.key||i,i.value)):i=new U(i);let o=X(this.items,i.key),u=this.schema&&this.schema.sortMapEntries;if(o)if(n)o.value=i.value;else throw new Error(`Key ${i.key} already set`);else if(u){let h=this.items.findIndex(m=>u(i,m)<0);h===-1?this.items.push(i):this.items.splice(h,0,i)}else this.items.push(i)}delete(i){let n=X(this.items,i);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(i,n){let o=X(this.items,i),u=o&&o.value;return!n&&u instanceof c?u.value:u}has(i){return!!X(this.items,i)}set(i,n){this.add(new U(i,n),!0)}toJSON(i,n,o){let u=o?new o:n&&n.mapAsMap?new Map:{};n&&n.onCreate&&n.onCreate(u);for(let h of this.items)h.addToJSMap(n,u);return u}toString(i,n,o){if(!i)return JSON.stringify(this);for(let u of this.items)if(!(u instanceof U))throw new Error(`Map items must all be pairs; found ${JSON.stringify(u)} instead`);return super.toString(i,{blockItem:u=>u.str,flowChars:{start:"{",end:"}"},isMap:!0,itemIndent:i.indent||""},n,o)}},de="<<",F=class extends U{constructor(i){if(i instanceof U){let n=i.value;n instanceof A||(n=new A,n.items.push(i.value),n.range=i.value.range),super(i.key,n),this.range=i.range}else super(new c(de),new A);this.type=U.Type.MERGE_PAIR}addToJSMap(i,n){for(let{source:o}of this.value.items){if(!(o instanceof fe))throw new Error("Merge sources must be maps");let u=o.toJSON(null,i,Map);for(let[h,m]of u)n instanceof Map?n.has(h)||n.set(h,m):n instanceof Set?n.add(h):Object.prototype.hasOwnProperty.call(n,h)||Object.defineProperty(n,h,{value:m,writable:!0,enumerable:!0,configurable:!0})}return n}toString(i,n){let o=this.value;if(o.items.length>1)return super.toString(i,n);this.value=o.items[0];let u=super.toString(i,n);return this.value=o,u}},g={defaultType:t.Type.BLOCK_LITERAL,lineWidth:76},w={trueStr:"true",falseStr:"false"},T={asBigInt:!1},_={nullStr:"null"},N={defaultType:t.Type.PLAIN,doubleQuoted:{jsonEncoding:!1,minMultiLineLength:40},fold:{lineWidth:80,minContentWidth:20}};function b(i,n,o){for(let{format:u,test:h,resolve:m}of n)if(h){let v=i.match(h);if(v){let O=m.apply(null,v);return O instanceof c||(O=new c(O)),u&&(O.format=u),O}}return o&&(i=o(i)),new c(i)}var I="flow",k="block",B="quoted",H=(i,n)=>{let o=i[n+1];for(;o===" "||o==="	";){do o=i[n+=1];while(o&&o!==`
`);o=i[n+1]}return n};function Z(i,n,o,{indentAtStart:u,lineWidth:h=80,minContentWidth:m=20,onFold:v,onOverflow:O}){if(!h||h<0)return i;let R=Math.max(1+m,1+h-n.length);if(i.length<=R)return i;let L=[],V={},J=h-n.length;typeof u=="number"&&(u>h-Math.max(2,m)?L.push(0):J=h-u);let ge,re,he=!1,ne=-1,pe=-1,Pe=-1;o===k&&(ne=H(i,ne),ne!==-1&&(J=ne+R));for(let Ee;Ee=i[ne+=1];){if(o===B&&Ee==="\\"){switch(pe=ne,i[ne+1]){case"x":ne+=3;break;case"u":ne+=5;break;case"U":ne+=9;break;default:ne+=1}Pe=ne}if(Ee===`
`)o===k&&(ne=H(i,ne)),J=ne+R,ge=void 0;else{if(Ee===" "&&re&&re!==" "&&re!==`
`&&re!=="	"){let ce=i[ne+1];ce&&ce!==" "&&ce!==`
`&&ce!=="	"&&(ge=ne)}if(ne>=J)if(ge)L.push(ge),J=ge+R,ge=void 0;else if(o===B){for(;re===" "||re==="	";)re=Ee,Ee=i[ne+=1],he=!0;let ce=ne>Pe+1?ne-2:pe-1;if(V[ce])return i;L.push(ce),V[ce]=!0,J=ce+R,ge=void 0}else he=!0}re=Ee}if(he&&O&&O(),L.length===0)return i;v&&v();let oe=i.slice(0,L[0]);for(let Ee=0;Ee<L.length;++Ee){let ce=L[Ee],Me=L[Ee+1]||i.length;ce===0?oe=`
${n}${i.slice(0,Me)}`:(o===B&&V[ce]&&(oe+=`${i[ce]}\\`),oe+=`
${n}${i.slice(ce+1,Me)}`)}return oe}var we=({indentAtStart:i})=>i?Object.assign({indentAtStart:i},N.fold):N.fold,Se=i=>/^(%|---|\.\.\.)/m.test(i);function Oe(i,n,o){if(!n||n<0)return!1;let u=n-o,h=i.length;if(h<=u)return!1;for(let m=0,v=0;m<h;++m)if(i[m]===`
`){if(m-v>u)return!0;if(v=m+1,h-v<=u)return!1}return!0}function Te(i,n){let{implicitKey:o}=n,{jsonEncoding:u,minMultiLineLength:h}=N.doubleQuoted,m=JSON.stringify(i);if(u)return m;let v=n.indent||(Se(i)?"  ":""),O="",R=0;for(let L=0,V=m[L];V;V=m[++L])if(V===" "&&m[L+1]==="\\"&&m[L+2]==="n"&&(O+=m.slice(R,L)+"\\ ",L+=1,R=L,V="\\"),V==="\\")switch(m[L+1]){case"u":{O+=m.slice(R,L);let J=m.substr(L+2,4);switch(J){case"0000":O+="\\0";break;case"0007":O+="\\a";break;case"000b":O+="\\v";break;case"001b":O+="\\e";break;case"0085":O+="\\N";break;case"00a0":O+="\\_";break;case"2028":O+="\\L";break;case"2029":O+="\\P";break;default:J.substr(0,2)==="00"?O+="\\x"+J.substr(2):O+=m.substr(L,6)}L+=5,R=L+1}break;case"n":if(o||m[L+2]==='"'||m.length<h)L+=1;else{for(O+=m.slice(R,L)+`

`;m[L+2]==="\\"&&m[L+3]==="n"&&m[L+4]!=='"';)O+=`
`,L+=2;O+=v,m[L+2]===" "&&(O+="\\"),L+=1,R=L+1}break;default:L+=1}return O=R?O+m.slice(R):m,o?O:Z(O,v,B,we(n))}function _e(i,n){if(n.implicitKey){if(/\n/.test(i))return Te(i,n)}else if(/[ \t]\n|\n[ \t]/.test(i))return Te(i,n);let o=n.indent||(Se(i)?"  ":""),u="'"+i.replace(/'/g,"''").replace(/\n+/g,`$&
${o}`)+"'";return n.implicitKey?u:Z(u,o,I,we(n))}function W({comment:i,type:n,value:o},u,h,m){if(/\n[\t ]+$/.test(o)||/^\s*$/.test(o))return Te(o,u);let v=u.indent||(u.forceBlockIndent||Se(o)?"  ":""),O=v?"2":"1",R=n===t.Type.BLOCK_FOLDED?!1:n===t.Type.BLOCK_LITERAL?!0:!Oe(o,N.fold.lineWidth,v.length),L=R?"|":">";if(!o)return L+`
`;let V="",J="";if(o=o.replace(/[\n\t ]*$/,re=>{let he=re.indexOf(`
`);return he===-1?L+="-":(o===re||he!==re.length-1)&&(L+="+",m&&m()),J=re.replace(/\n$/,""),""}).replace(/^[\n ]*/,re=>{re.indexOf(" ")!==-1&&(L+=O);let he=re.match(/ +$/);return he?(V=re.slice(0,-he[0].length),he[0]):(V=re,"")}),J&&(J=J.replace(/\n+(?!\n|$)/g,`$&${v}`)),V&&(V=V.replace(/\n+/g,`$&${v}`)),i&&(L+=" #"+i.replace(/ ?[\r\n]+/g," "),h&&h()),!o)return`${L}${O}
${v}${J}`;if(R)return o=o.replace(/\n+/g,`$&${v}`),`${L}
${v}${V}${o}${J}`;o=o.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${v}`);let ge=Z(`${V}${o}${J}`,v,k,N.fold);return`${L}
${v}${ge}`}function p(i,n,o,u){let{comment:h,type:m,value:v}=i,{actualString:O,implicitKey:R,indent:L,inFlow:V}=n;if(R&&/[\n[\]{},]/.test(v)||V&&/[[\]{},]/.test(v))return Te(v,n);if(!v||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(v))return R||V||v.indexOf(`
`)===-1?v.indexOf('"')!==-1&&v.indexOf("'")===-1?_e(v,n):Te(v,n):W(i,n,o,u);if(!R&&!V&&m!==t.Type.PLAIN&&v.indexOf(`
`)!==-1)return W(i,n,o,u);if(L===""&&Se(v))return n.forceBlockIndent=!0,W(i,n,o,u);let J=v.replace(/\n+/g,`$&
${L}`);if(O){let{tags:re}=n.doc.schema;if(typeof b(J,re,re.scalarFallback).value!="string")return Te(v,n)}let ge=R?J:Z(J,L,I,we(n));return h&&!V&&(ge.indexOf(`
`)!==-1||h.indexOf(`
`)!==-1)?(o&&o(),r(ge,L,h)):ge}function M(i,n,o,u){let{defaultType:h}=N,{implicitKey:m,inFlow:v}=n,{type:O,value:R}=i;typeof R!="string"&&(R=String(R),i=Object.assign({},i,{value:R}));let L=J=>{switch(J){case t.Type.BLOCK_FOLDED:case t.Type.BLOCK_LITERAL:return W(i,n,o,u);case t.Type.QUOTE_DOUBLE:return Te(R,n);case t.Type.QUOTE_SINGLE:return _e(R,n);case t.Type.PLAIN:return p(i,n,o,u);default:return null}};(O!==t.Type.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f]/.test(R)||(m||v)&&(O===t.Type.BLOCK_FOLDED||O===t.Type.BLOCK_LITERAL))&&(O=t.Type.QUOTE_DOUBLE);let V=L(O);if(V===null&&(V=L(h),V===null))throw new Error(`Unsupported default string type ${h}`);return V}function q({format:i,minFractionDigits:n,tag:o,value:u}){if(typeof u=="bigint")return String(u);if(!isFinite(u))return isNaN(u)?".nan":u<0?"-.inf":".inf";let h=JSON.stringify(u);if(!i&&n&&(!o||o==="tag:yaml.org,2002:float")&&/^\d/.test(h)){let m=h.indexOf(".");m<0&&(m=h.length,h+=".");let v=n-(h.length-m-1);for(;v-- >0;)h+="0"}return h}function K(i,n){let o,u;switch(n.type){case t.Type.FLOW_MAP:o="}",u="flow map";break;case t.Type.FLOW_SEQ:o="]",u="flow sequence";break;default:i.push(new t.YAMLSemanticError(n,"Not a flow collection!?"));return}let h;for(let m=n.items.length-1;m>=0;--m){let v=n.items[m];if(!v||v.type!==t.Type.COMMENT){h=v;break}}if(h&&h.char!==o){let m=`Expected ${u} to end with ${o}`,v;typeof h.offset=="number"?(v=new t.YAMLSemanticError(n,m),v.offset=h.offset+1):(v=new t.YAMLSemanticError(h,m),h.range&&h.range.end&&(v.offset=h.range.end-h.range.start)),i.push(v)}}function ee(i,n){let o=n.context.src[n.range.start-1];if(o!==`
`&&o!=="	"&&o!==" "){let u="Comments must be separated from other tokens by white space characters";i.push(new t.YAMLSemanticError(n,u))}}function se(i,n){let o=String(n),u=o.substr(0,8)+"..."+o.substr(-8);return new t.YAMLSemanticError(i,`The "${u}" key is too long`)}function De(i,n){for(let{afterKey:o,before:u,comment:h}of n){let m=i.items[u];m?(o&&m.value&&(m=m.value),h===void 0?(o||!m.commentBefore)&&(m.spaceBefore=!0):m.commentBefore?m.commentBefore+=`
`+h:m.commentBefore=h):h!==void 0&&(i.comment?i.comment+=`
`+h:i.comment=h)}}function qe(i,n){let o=n.strValue;return o?typeof o=="string"?o:(o.errors.forEach(u=>{u.source||(u.source=n),i.errors.push(u)}),o.str):""}function Ke(i,n){let{handle:o,suffix:u}=n.tag,h=i.tagPrefixes.find(m=>m.handle===o);if(!h){let m=i.getDefaults().tagPrefixes;if(m&&(h=m.find(v=>v.handle===o)),!h)throw new t.YAMLSemanticError(n,`The ${o} tag handle is non-default and was not declared.`)}if(!u)throw new t.YAMLSemanticError(n,`The ${o} tag has no suffix.`);if(o==="!"&&(i.version||i.options.version)==="1.0"){if(u[0]==="^")return i.warnings.push(new t.YAMLWarning(n,"YAML 1.0 ^ tag expansion is not supported")),u;if(/[:/]/.test(u)){let m=u.match(/^([a-z0-9-]+)\/(.*)/i);return m?`tag:${m[1]}.yaml.org,2002:${m[2]}`:`tag:${u}`}}return h.prefix+decodeURIComponent(u)}function Ye(i,n){let{tag:o,type:u}=n,h=!1;if(o){let{handle:m,suffix:v,verbatim:O}=o;if(O){if(O!=="!"&&O!=="!!")return O;let R=`Verbatim tags aren't resolved, so ${O} is invalid.`;i.errors.push(new t.YAMLSemanticError(n,R))}else if(m==="!"&&!v)h=!0;else try{return Ke(i,n)}catch(R){i.errors.push(R)}}switch(u){case t.Type.BLOCK_FOLDED:case t.Type.BLOCK_LITERAL:case t.Type.QUOTE_DOUBLE:case t.Type.QUOTE_SINGLE:return t.defaultTags.STR;case t.Type.FLOW_MAP:case t.Type.MAP:return t.defaultTags.MAP;case t.Type.FLOW_SEQ:case t.Type.SEQ:return t.defaultTags.SEQ;case t.Type.PLAIN:return h?t.defaultTags.STR:null;default:return null}}function ft(i,n,o){let{tags:u}=i.schema,h=[];for(let v of u)if(v.tag===o)if(v.test)h.push(v);else{let O=v.resolve(i,n);return O instanceof S?O:new c(O)}let m=qe(i,n);return typeof m=="string"&&h.length>0?b(m,h,u.scalarFallback):null}function Rt({type:i}){switch(i){case t.Type.FLOW_MAP:case t.Type.MAP:return t.defaultTags.MAP;case t.Type.FLOW_SEQ:case t.Type.SEQ:return t.defaultTags.SEQ;default:return t.defaultTags.STR}}function hs(i,n,o){try{let u=ft(i,n,o);if(u)return o&&n.tag&&(u.tag=o),u}catch(u){return u.source||(u.source=n),i.errors.push(u),null}try{let u=Rt(n);if(!u)throw new Error(`The tag ${o} is unavailable`);let h=`The tag ${o} is unavailable, falling back to ${u}`;i.warnings.push(new t.YAMLWarning(n,h));let m=ft(i,n,u);return m.tag=o,m}catch(u){let h=new t.YAMLReferenceError(n,u.message);return h.stack=u.stack,i.errors.push(h),null}}var ms=i=>{if(!i)return!1;let{type:n}=i;return n===t.Type.MAP_KEY||n===t.Type.MAP_VALUE||n===t.Type.SEQ_ITEM};function gs(i,n){let o={before:[],after:[]},u=!1,h=!1,m=ms(n.context.parent)?n.context.parent.props.concat(n.props):n.props;for(let{start:v,end:O}of m)switch(n.context.src[v]){case t.Char.COMMENT:{if(!n.commentHasRequiredWhitespace(v)){let J="Comments must be separated from other tokens by white space characters";i.push(new t.YAMLSemanticError(n,J))}let{header:R,valueRange:L}=n;(L&&(v>L.start||R&&v>R.start)?o.after:o.before).push(n.context.src.slice(v+1,O));break}case t.Char.ANCHOR:if(u){let R="A node can have at most one anchor";i.push(new t.YAMLSemanticError(n,R))}u=!0;break;case t.Char.TAG:if(h){let R="A node can have at most one tag";i.push(new t.YAMLSemanticError(n,R))}h=!0;break}return{comments:o,hasAnchor:u,hasTag:h}}function ys(i,n){let{anchors:o,errors:u,schema:h}=i;if(n.type===t.Type.ALIAS){let v=n.rawValue,O=o.getNode(v);if(!O){let L=`Aliased anchor not found: ${v}`;return u.push(new t.YAMLReferenceError(n,L)),null}let R=new G(O);return o._cstAliases.push(R),R}let m=Ye(i,n);if(m)return hs(i,n,m);if(n.type!==t.Type.PLAIN){let v=`Failed to resolve ${n.type} node here`;return u.push(new t.YAMLSyntaxError(n,v)),null}try{let v=qe(i,n);return b(v,h.tags,h.tags.scalarFallback)}catch(v){return v.source||(v.source=n),u.push(v),null}}function Ge(i,n){if(!n)return null;n.error&&i.errors.push(n.error);let{comments:o,hasAnchor:u,hasTag:h}=gs(i.errors,n);if(u){let{anchors:v}=i,O=n.anchor,R=v.getNode(O);R&&(v.map[v.newName(O)]=R),v.map[O]=n}if(n.type===t.Type.ALIAS&&(u||h)){let v="An alias node must not specify any properties";i.errors.push(new t.YAMLSemanticError(n,v))}let m=ys(i,n);if(m){m.range=[n.range.start,n.range.end],i.options.keepCstNodes&&(m.cstNode=n),i.options.keepNodeTypes&&(m.type=n.type);let v=o.before.join(`
`);v&&(m.commentBefore=m.commentBefore?`${m.commentBefore}
${v}`:v);let O=o.after.join(`
`);O&&(m.comment=m.comment?`${m.comment}
${O}`:O)}return n.resolved=m}function ws(i,n){if(n.type!==t.Type.MAP&&n.type!==t.Type.FLOW_MAP){let v=`A ${n.type} node cannot be resolved as a mapping`;return i.errors.push(new t.YAMLSyntaxError(n,v)),null}let{comments:o,items:u}=n.type===t.Type.FLOW_MAP?Os(i,n):vs(i,n),h=new fe;h.items=u,De(h,o);let m=!1;for(let v=0;v<u.length;++v){let{key:O}=u[v];if(O instanceof S&&(m=!0),i.schema.merge&&O&&O.value===de){u[v]=new F(u[v]);let R=u[v].value.items,L=null;R.some(V=>{if(V instanceof G){let{type:J}=V.source;return J===t.Type.MAP||J===t.Type.FLOW_MAP?!1:L="Merge nodes aliases can only point to maps"}return L="Merge nodes can only have Alias nodes as values"}),L&&i.errors.push(new t.YAMLSemanticError(n,L))}else for(let R=v+1;R<u.length;++R){let{key:L}=u[R];if(O===L||O&&L&&Object.prototype.hasOwnProperty.call(O,"value")&&O.value===L.value){let V=`Map keys must be unique; "${O}" is repeated`;i.errors.push(new t.YAMLSemanticError(n,V));break}}}if(m&&!i.options.mapAsMap){let v="Keys with collection values will be stringified as YAML due to JS Object restrictions. Use mapAsMap: true to avoid this.";i.warnings.push(new t.YAMLWarning(n,v))}return n.resolved=h,h}var Ss=({context:{lineStart:i,node:n,src:o},props:u})=>{if(u.length===0)return!1;let{start:h}=u[0];if(n&&h>n.valueRange.start||o[h]!==t.Char.COMMENT)return!1;for(let m=i;m<h;++m)if(o[m]===`
`)return!1;return!0};function Es(i,n){if(!Ss(i))return;let o=i.getPropValue(0,t.Char.COMMENT,!0),u=!1,h=n.value.commentBefore;if(h&&h.startsWith(o))n.value.commentBefore=h.substr(o.length+1),u=!0;else{let m=n.value.comment;!i.node&&m&&m.startsWith(o)&&(n.value.comment=m.substr(o.length+1),u=!0)}u&&(n.comment=o)}function vs(i,n){let o=[],u=[],h,m=null;for(let v=0;v<n.items.length;++v){let O=n.items[v];switch(O.type){case t.Type.BLANK_LINE:o.push({afterKey:!!h,before:u.length});break;case t.Type.COMMENT:o.push({afterKey:!!h,before:u.length,comment:O.comment});break;case t.Type.MAP_KEY:h!==void 0&&u.push(new U(h)),O.error&&i.errors.push(O.error),h=Ge(i,O.node),m=null;break;case t.Type.MAP_VALUE:{if(h===void 0&&(h=null),O.error&&i.errors.push(O.error),!O.context.atLineStart&&O.node&&O.node.type===t.Type.MAP&&!O.node.context.atLineStart){let V="Nested mappings are not allowed in compact mappings";i.errors.push(new t.YAMLSemanticError(O.node,V))}let R=O.node;if(!R&&O.props.length>0){R=new t.PlainValue(t.Type.PLAIN,[]),R.context={parent:O,src:O.context.src};let V=O.range.start+1;if(R.range={start:V,end:V},R.valueRange={start:V,end:V},typeof O.range.origStart=="number"){let J=O.range.origStart+1;R.range.origStart=R.range.origEnd=J,R.valueRange.origStart=R.valueRange.origEnd=J}}let L=new U(h,Ge(i,R));Es(O,L),u.push(L),h&&typeof m=="number"&&O.range.start>m+1024&&i.errors.push(se(n,h)),h=void 0,m=null}break;default:h!==void 0&&u.push(new U(h)),h=Ge(i,O),m=O.range.start,O.error&&i.errors.push(O.error);e:for(let R=v+1;;++R){let L=n.items[R];switch(L&&L.type){case t.Type.BLANK_LINE:case t.Type.COMMENT:continue e;case t.Type.MAP_VALUE:break e;default:{let V="Implicit map keys need to be followed by map values";i.errors.push(new t.YAMLSemanticError(O,V));break e}}}if(O.valueRangeContainsNewline){let R="Implicit map keys need to be on a single line";i.errors.push(new t.YAMLSemanticError(O,R))}}}return h!==void 0&&u.push(new U(h)),{comments:o,items:u}}function Os(i,n){let o=[],u=[],h,m=!1,v="{";for(let O=0;O<n.items.length;++O){let R=n.items[O];if(typeof R.char=="string"){let{char:L,offset:V}=R;if(L==="?"&&h===void 0&&!m){m=!0,v=":";continue}if(L===":"){if(h===void 0&&(h=null),v===":"){v=",";continue}}else if(m&&(h===void 0&&L!==","&&(h=null),m=!1),h!==void 0&&(u.push(new U(h)),h=void 0,L===",")){v=":";continue}if(L==="}"){if(O===n.items.length-1)continue}else if(L===v){v=":";continue}let J=`Flow map contains an unexpected ${L}`,ge=new t.YAMLSyntaxError(n,J);ge.offset=V,i.errors.push(ge)}else R.type===t.Type.BLANK_LINE?o.push({afterKey:!!h,before:u.length}):R.type===t.Type.COMMENT?(ee(i.errors,R),o.push({afterKey:!!h,before:u.length,comment:R.comment})):h===void 0?(v===","&&i.errors.push(new t.YAMLSemanticError(R,"Separator , missing in flow map")),h=Ge(i,R)):(v!==","&&i.errors.push(new t.YAMLSemanticError(R,"Indicator : missing in flow map entry")),u.push(new U(h,Ge(i,R))),h=void 0,m=!1)}return K(i.errors,n),h!==void 0&&u.push(new U(h)),{comments:o,items:u}}function As(i,n){if(n.type!==t.Type.SEQ&&n.type!==t.Type.FLOW_SEQ){let m=`A ${n.type} node cannot be resolved as a sequence`;return i.errors.push(new t.YAMLSyntaxError(n,m)),null}let{comments:o,items:u}=n.type===t.Type.FLOW_SEQ?Ts(i,n):bs(i,n),h=new A;if(h.items=u,De(h,o),!i.options.mapAsMap&&u.some(m=>m instanceof U&&m.key instanceof S)){let m="Keys with collection values will be stringified as YAML due to JS Object restrictions. Use mapAsMap: true to avoid this.";i.warnings.push(new t.YAMLWarning(n,m))}return n.resolved=h,h}function bs(i,n){let o=[],u=[];for(let h=0;h<n.items.length;++h){let m=n.items[h];switch(m.type){case t.Type.BLANK_LINE:o.push({before:u.length});break;case t.Type.COMMENT:o.push({comment:m.comment,before:u.length});break;case t.Type.SEQ_ITEM:if(m.error&&i.errors.push(m.error),u.push(Ge(i,m.node)),m.hasProps){let v="Sequence items cannot have tags or anchors before the - indicator";i.errors.push(new t.YAMLSemanticError(m,v))}break;default:m.error&&i.errors.push(m.error),i.errors.push(new t.YAMLSyntaxError(m,`Unexpected ${m.type} node in sequence`))}}return{comments:o,items:u}}function Ts(i,n){let o=[],u=[],h=!1,m,v=null,O="[",R=null;for(let L=0;L<n.items.length;++L){let V=n.items[L];if(typeof V.char=="string"){let{char:J,offset:ge}=V;if(J!==":"&&(h||m!==void 0)&&(h&&m===void 0&&(m=O?u.pop():null),u.push(new U(m)),h=!1,m=void 0,v=null),J===O)O=null;else if(!O&&J==="?")h=!0;else if(O!=="["&&J===":"&&m===void 0){if(O===","){if(m=u.pop(),m instanceof U){let re="Chaining flow sequence pairs is invalid",he=new t.YAMLSemanticError(n,re);he.offset=ge,i.errors.push(he)}if(!h&&typeof v=="number"){let re=V.range?V.range.start:V.offset;re>v+1024&&i.errors.push(se(n,m));let{src:he}=R.context;for(let ne=v;ne<re;++ne)if(he[ne]===`
`){let pe="Implicit keys of flow sequence pairs need to be on a single line";i.errors.push(new t.YAMLSemanticError(R,pe));break}}}else m=null;v=null,h=!1,O=null}else if(O==="["||J!=="]"||L<n.items.length-1){let re=`Flow sequence contains an unexpected ${J}`,he=new t.YAMLSyntaxError(n,re);he.offset=ge,i.errors.push(he)}}else if(V.type===t.Type.BLANK_LINE)o.push({before:u.length});else if(V.type===t.Type.COMMENT)ee(i.errors,V),o.push({comment:V.comment,before:u.length});else{if(O){let ge=`Expected a ${O} in flow sequence`;i.errors.push(new t.YAMLSemanticError(V,ge))}let J=Ge(i,V);m===void 0?(u.push(J),R=V):(u.push(new U(m,J)),m=void 0),v=V.range.start,O=","}}return K(i.errors,n),m!==void 0&&u.push(new U(m)),{comments:o,items:u}}e.Alias=G,e.Collection=S,e.Merge=F,e.Node=l,e.Pair=U,e.Scalar=c,e.YAMLMap=fe,e.YAMLSeq=A,e.addComment=a,e.binaryOptions=g,e.boolOptions=w,e.findPair=X,e.intOptions=T,e.isEmptyPath=C,e.nullOptions=_,e.resolveMap=ws,e.resolveNode=Ge,e.resolveSeq=As,e.resolveString=qe,e.strOptions=N,e.stringifyNumber=q,e.stringifyString=M,e.toJSON=f}}),zt=Ce({"node_modules/yaml/dist/warnings-1000a372.js"(e){"use strict";var t=ot(),r=Et(),a={identify:b=>b instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve:(b,I)=>{let k=r.resolveString(b,I);if(typeof Buffer=="function")return Buffer.from(k,"base64");if(typeof atob=="function"){let B=atob(k.replace(/[\n\r]/g,"")),H=new Uint8Array(B.length);for(let Z=0;Z<B.length;++Z)H[Z]=B.charCodeAt(Z);return H}else{let B="This environment does not support reading binary tags; either Buffer or atob is required";return b.errors.push(new t.YAMLReferenceError(I,B)),null}},options:r.binaryOptions,stringify:({comment:b,type:I,value:k},B,H,Z)=>{let we;if(typeof Buffer=="function")we=k instanceof Buffer?k.toString("base64"):Buffer.from(k.buffer).toString("base64");else if(typeof btoa=="function"){let Se="";for(let Oe=0;Oe<k.length;++Oe)Se+=String.fromCharCode(k[Oe]);we=btoa(Se)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(I||(I=r.binaryOptions.defaultType),I===t.Type.QUOTE_DOUBLE)k=we;else{let{lineWidth:Se}=r.binaryOptions,Oe=Math.ceil(we.length/Se),Te=new Array(Oe);for(let _e=0,W=0;_e<Oe;++_e,W+=Se)Te[_e]=we.substr(W,Se);k=Te.join(I===t.Type.BLOCK_LITERAL?`
`:" ")}return r.stringifyString({comment:b,type:I,value:k},B,H,Z)}};function l(b,I){let k=r.resolveSeq(b,I);for(let B=0;B<k.items.length;++B){let H=k.items[B];if(!(H instanceof r.Pair)){if(H instanceof r.YAMLMap){if(H.items.length>1){let we="Each pair must have its own sequence indicator";throw new t.YAMLSemanticError(I,we)}let Z=H.items[0]||new r.Pair;H.commentBefore&&(Z.commentBefore=Z.commentBefore?`${H.commentBefore}
${Z.commentBefore}`:H.commentBefore),H.comment&&(Z.comment=Z.comment?`${H.comment}
${Z.comment}`:H.comment),H=Z}k.items[B]=H instanceof r.Pair?H:new r.Pair(H)}}return k}function f(b,I,k){let B=new r.YAMLSeq(b);B.tag="tag:yaml.org,2002:pairs";for(let H of I){let Z,we;if(Array.isArray(H))if(H.length===2)Z=H[0],we=H[1];else throw new TypeError(`Expected [key, value] tuple: ${H}`);else if(H&&H instanceof Object){let Oe=Object.keys(H);if(Oe.length===1)Z=Oe[0],we=H[Z];else throw new TypeError(`Expected { key: value } tuple: ${H}`)}else Z=H;let Se=b.createPair(Z,we,k);B.items.push(Se)}return B}var c={default:!1,tag:"tag:yaml.org,2002:pairs",resolve:l,createNode:f},E=class ci extends r.YAMLSeq{constructor(){super(),t._defineProperty(this,"add",r.YAMLMap.prototype.add.bind(this)),t._defineProperty(this,"delete",r.YAMLMap.prototype.delete.bind(this)),t._defineProperty(this,"get",r.YAMLMap.prototype.get.bind(this)),t._defineProperty(this,"has",r.YAMLMap.prototype.has.bind(this)),t._defineProperty(this,"set",r.YAMLMap.prototype.set.bind(this)),this.tag=ci.tag}toJSON(I,k){let B=new Map;k&&k.onCreate&&k.onCreate(B);for(let H of this.items){let Z,we;if(H instanceof r.Pair?(Z=r.toJSON(H.key,"",k),we=r.toJSON(H.value,Z,k)):Z=r.toJSON(H,"",k),B.has(Z))throw new Error("Ordered maps must not include duplicate keys");B.set(Z,we)}return B}};t._defineProperty(E,"tag","tag:yaml.org,2002:omap");function C(b,I){let k=l(b,I),B=[];for(let{key:H}of k.items)if(H instanceof r.Scalar)if(B.includes(H.value)){let Z="Ordered maps must not include duplicate keys";throw new t.YAMLSemanticError(I,Z)}else B.push(H.value);return Object.assign(new E,k)}function S(b,I,k){let B=f(b,I,k),H=new E;return H.items=B.items,H}var D={identify:b=>b instanceof Map,nodeClass:E,default:!1,tag:"tag:yaml.org,2002:omap",resolve:C,createNode:S},A=class fi extends r.YAMLMap{constructor(){super(),this.tag=fi.tag}add(I){let k=I instanceof r.Pair?I:new r.Pair(I);r.findPair(this.items,k.key)||this.items.push(k)}get(I,k){let B=r.findPair(this.items,I);return!k&&B instanceof r.Pair?B.key instanceof r.Scalar?B.key.value:B.key:B}set(I,k){if(typeof k!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof k}`);let B=r.findPair(this.items,I);B&&!k?this.items.splice(this.items.indexOf(B),1):!B&&k&&this.items.push(new r.Pair(I))}toJSON(I,k){return super.toJSON(I,k,Set)}toString(I,k,B){if(!I)return JSON.stringify(this);if(this.hasAllNullValues())return super.toString(I,k,B);throw new Error("Set items must all have null values")}};t._defineProperty(A,"tag","tag:yaml.org,2002:set");function Y(b,I){let k=r.resolveMap(b,I);if(!k.hasAllNullValues())throw new t.YAMLSemanticError(I,"Set items must all have null values");return Object.assign(new A,k)}function U(b,I,k){let B=new A;for(let H of I)B.items.push(b.createPair(H,null,k));return B}var ie={identify:b=>b instanceof Set,nodeClass:A,default:!1,tag:"tag:yaml.org,2002:set",resolve:Y,createNode:U},G=(b,I)=>{let k=I.split(":").reduce((B,H)=>B*60+Number(H),0);return b==="-"?-k:k},X=({value:b})=>{if(isNaN(b)||!isFinite(b))return r.stringifyNumber(b);let I="";b<0&&(I="-",b=Math.abs(b));let k=[b%60];return b<60?k.unshift(0):(b=Math.round((b-k[0])/60),k.unshift(b%60),b>=60&&(b=Math.round((b-k[0])/60),k.unshift(b))),I+k.map(B=>B<10?"0"+String(B):String(B)).join(":").replace(/000000\d*$/,"")},fe={identify:b=>typeof b=="number",default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^([-+]?)([0-9][0-9_]*(?::[0-5]?[0-9])+)$/,resolve:(b,I,k)=>G(I,k.replace(/_/g,"")),stringify:X},de={identify:b=>typeof b=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^([-+]?)([0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*)$/,resolve:(b,I,k)=>G(I,k.replace(/_/g,"")),stringify:X},F={identify:b=>b instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^(?:([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?)$"),resolve:(b,I,k,B,H,Z,we,Se,Oe)=>{Se&&(Se=(Se+"00").substr(1,3));let Te=Date.UTC(I,k-1,B,H||0,Z||0,we||0,Se||0);if(Oe&&Oe!=="Z"){let _e=G(Oe[0],Oe.slice(1));Math.abs(_e)<30&&(_e*=60),Te-=6e4*_e}return new Date(Te)},stringify:({value:b})=>b.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")};function g(b){let I=typeof process!="undefined"&&process.env||{};return b?typeof YAML_SILENCE_DEPRECATION_WARNINGS!="undefined"?!YAML_SILENCE_DEPRECATION_WARNINGS:!I.YAML_SILENCE_DEPRECATION_WARNINGS:typeof YAML_SILENCE_WARNINGS!="undefined"?!YAML_SILENCE_WARNINGS:!I.YAML_SILENCE_WARNINGS}function w(b,I){if(g(!1)){let k=typeof process!="undefined"&&process.emitWarning;k?k(b,I):console.warn(I?`${I}: ${b}`:b)}}function T(b){if(g(!0)){let I=b.replace(/.*yaml[/\\]/i,"").replace(/\.js$/,"").replace(/\\/g,"/");w(`The endpoint 'yaml/${I}' will be removed in a future release.`,"DeprecationWarning")}}var _={};function N(b,I){if(!_[b]&&g(!0)){_[b]=!0;let k=`The option '${b}' will be removed in a future release`;k+=I?`, use '${I}' instead.`:".",w(k,"DeprecationWarning")}}e.binary=a,e.floatTime=de,e.intTime=fe,e.omap=D,e.pairs=c,e.set=ie,e.timestamp=F,e.warn=w,e.warnFileDeprecation=T,e.warnOptionDeprecation=N}}),Br=Ce({"node_modules/yaml/dist/Schema-88e323a7.js"(e){"use strict";var t=ot(),r=Et(),a=zt();function l(p,M,q){let K=new r.YAMLMap(p);if(M instanceof Map)for(let[ee,se]of M)K.items.push(p.createPair(ee,se,q));else if(M&&typeof M=="object")for(let ee of Object.keys(M))K.items.push(p.createPair(ee,M[ee],q));return typeof p.sortMapEntries=="function"&&K.items.sort(p.sortMapEntries),K}var f={createNode:l,default:!0,nodeClass:r.YAMLMap,tag:"tag:yaml.org,2002:map",resolve:r.resolveMap};function c(p,M,q){let K=new r.YAMLSeq(p);if(M&&M[Symbol.iterator])for(let ee of M){let se=p.createNode(ee,q.wrapScalars,null,q);K.items.push(se)}return K}var E={createNode:c,default:!0,nodeClass:r.YAMLSeq,tag:"tag:yaml.org,2002:seq",resolve:r.resolveSeq},C={identify:p=>typeof p=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:r.resolveString,stringify(p,M,q,K){return M=Object.assign({actualString:!0},M),r.stringifyString(p,M,q,K)},options:r.strOptions},S=[f,E,C],D=p=>typeof p=="bigint"||Number.isInteger(p),A=(p,M,q)=>r.intOptions.asBigInt?BigInt(p):parseInt(M,q);function Y(p,M,q){let{value:K}=p;return D(K)&&K>=0?q+K.toString(M):r.stringifyNumber(p)}var U={identify:p=>p==null,createNode:(p,M,q)=>q.wrapScalars?new r.Scalar(null):null,default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>null,options:r.nullOptions,stringify:()=>r.nullOptions.nullStr},ie={identify:p=>typeof p=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:p=>p[0]==="t"||p[0]==="T",options:r.boolOptions,stringify:({value:p})=>p?r.boolOptions.trueStr:r.boolOptions.falseStr},G={identify:p=>D(p)&&p>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o([0-7]+)$/,resolve:(p,M)=>A(p,M,8),options:r.intOptions,stringify:p=>Y(p,8,"0o")},X={identify:D,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:p=>A(p,p,10),options:r.intOptions,stringify:r.stringifyNumber},fe={identify:p=>D(p)&&p>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x([0-9a-fA-F]+)$/,resolve:(p,M)=>A(p,M,16),options:r.intOptions,stringify:p=>Y(p,16,"0x")},de={identify:p=>typeof p=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.inf|(\.nan))$/i,resolve:(p,M)=>M?NaN:p[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:r.stringifyNumber},F={identify:p=>typeof p=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:p=>parseFloat(p),stringify:({value:p})=>Number(p).toExponential()},g={identify:p=>typeof p=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.([0-9]+)|[0-9]+\.([0-9]*))$/,resolve(p,M,q){let K=M||q,ee=new r.Scalar(parseFloat(p));return K&&K[K.length-1]==="0"&&(ee.minFractionDigits=K.length),ee},stringify:r.stringifyNumber},w=S.concat([U,ie,G,X,fe,de,F,g]),T=p=>typeof p=="bigint"||Number.isInteger(p),_=({value:p})=>JSON.stringify(p),N=[f,E,{identify:p=>typeof p=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:r.resolveString,stringify:_},{identify:p=>p==null,createNode:(p,M,q)=>q.wrapScalars?new r.Scalar(null):null,default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:_},{identify:p=>typeof p=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:p=>p==="true",stringify:_},{identify:T,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:p=>r.intOptions.asBigInt?BigInt(p):parseInt(p,10),stringify:({value:p})=>T(p)?p.toString():JSON.stringify(p)},{identify:p=>typeof p=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:p=>parseFloat(p),stringify:_}];N.scalarFallback=p=>{throw new SyntaxError(`Unresolved plain scalar ${JSON.stringify(p)}`)};var b=({value:p})=>p?r.boolOptions.trueStr:r.boolOptions.falseStr,I=p=>typeof p=="bigint"||Number.isInteger(p);function k(p,M,q){let K=M.replace(/_/g,"");if(r.intOptions.asBigInt){switch(q){case 2:K=`0b${K}`;break;case 8:K=`0o${K}`;break;case 16:K=`0x${K}`;break}let se=BigInt(K);return p==="-"?BigInt(-1)*se:se}let ee=parseInt(K,q);return p==="-"?-1*ee:ee}function B(p,M,q){let{value:K}=p;if(I(K)){let ee=K.toString(M);return K<0?"-"+q+ee.substr(1):q+ee}return r.stringifyNumber(p)}var H=S.concat([{identify:p=>p==null,createNode:(p,M,q)=>q.wrapScalars?new r.Scalar(null):null,default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>null,options:r.nullOptions,stringify:()=>r.nullOptions.nullStr},{identify:p=>typeof p=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>!0,options:r.boolOptions,stringify:b},{identify:p=>typeof p=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:()=>!1,options:r.boolOptions,stringify:b},{identify:I,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^([-+]?)0b([0-1_]+)$/,resolve:(p,M,q)=>k(M,q,2),stringify:p=>B(p,2,"0b")},{identify:I,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^([-+]?)0([0-7_]+)$/,resolve:(p,M,q)=>k(M,q,8),stringify:p=>B(p,8,"0")},{identify:I,default:!0,tag:"tag:yaml.org,2002:int",test:/^([-+]?)([0-9][0-9_]*)$/,resolve:(p,M,q)=>k(M,q,10),stringify:r.stringifyNumber},{identify:I,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^([-+]?)0x([0-9a-fA-F_]+)$/,resolve:(p,M,q)=>k(M,q,16),stringify:p=>B(p,16,"0x")},{identify:p=>typeof p=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.inf|(\.nan))$/i,resolve:(p,M)=>M?NaN:p[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:r.stringifyNumber},{identify:p=>typeof p=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?([0-9][0-9_]*)?(\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:p=>parseFloat(p.replace(/_/g,"")),stringify:({value:p})=>Number(p).toExponential()},{identify:p=>typeof p=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.([0-9_]*)$/,resolve(p,M){let q=new r.Scalar(parseFloat(p.replace(/_/g,"")));if(M){let K=M.replace(/_/g,"");K[K.length-1]==="0"&&(q.minFractionDigits=K.length)}return q},stringify:r.stringifyNumber}],a.binary,a.omap,a.pairs,a.set,a.intTime,a.floatTime,a.timestamp),Z={core:w,failsafe:S,json:N,yaml11:H},we={binary:a.binary,bool:ie,float:g,floatExp:F,floatNaN:de,floatTime:a.floatTime,int:X,intHex:fe,intOct:G,intTime:a.intTime,map:f,null:U,omap:a.omap,pairs:a.pairs,seq:E,set:a.set,timestamp:a.timestamp};function Se(p,M,q){if(M){let K=q.filter(se=>se.tag===M),ee=K.find(se=>!se.format)||K[0];if(!ee)throw new Error(`Tag ${M} not found`);return ee}return q.find(K=>(K.identify&&K.identify(p)||K.class&&p instanceof K.class)&&!K.format)}function Oe(p,M,q){if(p instanceof r.Node)return p;let{defaultPrefix:K,onTagObj:ee,prevObjects:se,schema:De,wrapScalars:qe}=q;M&&M.startsWith("!!")&&(M=K+M.slice(2));let Ke=Se(p,M,De.tags);if(!Ke){if(typeof p.toJSON=="function"&&(p=p.toJSON()),!p||typeof p!="object")return qe?new r.Scalar(p):p;Ke=p instanceof Map?f:p[Symbol.iterator]?E:f}ee&&(ee(Ke),delete q.onTagObj);let Ye={value:void 0,node:void 0};if(p&&typeof p=="object"&&se){let ft=se.get(p);if(ft){let Rt=new r.Alias(ft);return q.aliasNodes.push(Rt),Rt}Ye.value=p,se.set(p,Ye)}return Ye.node=Ke.createNode?Ke.createNode(q.schema,p,q):qe?new r.Scalar(p):p,M&&Ye.node instanceof r.Node&&(Ye.node.tag=M),Ye.node}function Te(p,M,q,K){let ee=p[K.replace(/\W/g,"")];if(!ee){let se=Object.keys(p).map(De=>JSON.stringify(De)).join(", ");throw new Error(`Unknown schema "${K}"; use one of ${se}`)}if(Array.isArray(q))for(let se of q)ee=ee.concat(se);else typeof q=="function"&&(ee=q(ee.slice()));for(let se=0;se<ee.length;++se){let De=ee[se];if(typeof De=="string"){let qe=M[De];if(!qe){let Ke=Object.keys(M).map(Ye=>JSON.stringify(Ye)).join(", ");throw new Error(`Unknown custom tag "${De}"; use one of ${Ke}`)}ee[se]=qe}}return ee}var _e=(p,M)=>p.key<M.key?-1:p.key>M.key?1:0,W=class pi{constructor({customTags:M,merge:q,schema:K,sortMapEntries:ee,tags:se}){this.merge=!!q,this.name=K,this.sortMapEntries=ee===!0?_e:ee||null,!M&&se&&a.warnOptionDeprecation("tags","customTags"),this.tags=Te(Z,we,M||se,K)}createNode(M,q,K,ee){let se={defaultPrefix:pi.defaultPrefix,schema:this,wrapScalars:q},De=ee?Object.assign(ee,se):se;return Oe(M,K,De)}createPair(M,q,K){K||(K={wrapScalars:!0});let ee=this.createNode(M,K.wrapScalars,null,K),se=this.createNode(q,K.wrapScalars,null,K);return new r.Pair(ee,se)}};t._defineProperty(W,"defaultPrefix",t.defaultTagPrefix),t._defineProperty(W,"defaultTags",t.defaultTags),e.Schema=W}}),Vr=Ce({"node_modules/yaml/dist/types.js"(e){"use strict";var t=Et(),r=Br();ot(),zt(),e.Alias=t.Alias,e.Collection=t.Collection,e.Merge=t.Merge,e.Node=t.Node,e.Pair=t.Pair,e.Scalar=t.Scalar,e.YAMLMap=t.YAMLMap,e.YAMLSeq=t.YAMLSeq,e.binaryOptions=t.binaryOptions,e.boolOptions=t.boolOptions,e.intOptions=t.intOptions,e.nullOptions=t.nullOptions,e.strOptions=t.strOptions,e.Schema=r.Schema}}),Xt={},er=()=>Xt,Yr=e=>{Object.assign(Xt,e)},Hr=class{constructor(){this.data={}}unregister(e){e?delete this.data[e]:this.data={}}register(e,t){this.data[e]=t}registerMany(e){Object.keys(e).forEach(t=>{this.data[t]=e[t]})}get(e){return this.data[e]}list(){return this.data}},tr=Hr,le={},rr=le,le.defaultInvalidTypeProduct=void 0,le.defaultRandExpMax=10,le.pruneProperties=[],le.ignoreProperties=[],le.ignoreMissingRefs=!1,le.failOnInvalidTypes=!0,le.failOnInvalidFormat=!0,le.alwaysFakeOptionals=!1,le.optionalsProbability=null,le.fixedProbabilities=!1,le.useExamplesValue=!1,le.useDefaultValue=!1,le.requiredOnly=!1,le.omitNulls=!1,le.minItems=0,le.maxItems=null,le.minLength=0,le.maxLength=null,le.resolveJsonPath=!1,le.reuseProperties=!1,le.fillProperties=!0,le.sortProperties=!1,le.replaceEmptyByRandomValue=!1,le.random=Math.random,le.minDateTime=new Date("1889-12-31T00:00:00.000Z"),le.maxDateTime=new Date("1970-01-01T00:00:01.000Z"),le.renderTitle=!0,le.renderDescription=!0,le.renderComment=!1,qr=class extends tr{constructor(){super(),this.data={...rr},this._defaults=rr}get defaults(){return{...this._defaults}}},Kr=qr,at=new Kr,ke.getDefaults=()=>at.defaults,z=ke,nr=["integer","number","string","boolean"],ir=nr.concat(["null"]),Jr=["array","object"].concat(ir),Gr=2524608e6,Qr=-1e8,Zr=1e8,zr=-100,Xr=100,Ve={ALLOWED_TYPES:nr,SCALAR_TYPES:ir,ALL_TYPES:Jr,MIN_NUMBER:zr,MAX_NUMBER:Xr,MIN_INTEGER:Qr,MAX_INTEGER:Zr,MOST_NEAR_DATETIME:Gr},vt=Qt(jr(),1),Q={pick:Ne,date:Bt,shuffle:$e,number:Ue,randexp:be},en=/^(0|[1-9][0-9]*)$/,ue={hasProperties:Be,getLocalRef:br,omitProps:Pi,typecast:Si,merge:ze,clone:St,short:Ei,hasValue:vi,notValue:Oi,anyValue:Pr,validate:Ai,validateValueForSchema:Vt,validateValueForOneOf:bi,isKey:Ti,template:Rr,shouldClean:_r,clean:Ht,isEmpty:Yt,clampDate:Tr},tn=class{constructor(){this.registry={},this.support={}}reset(e){e?(delete this.registry[e],delete this.support[e]):(this.registry={},this.support={})}extend(e,t){this.registry[e]=t(this.registry[e]),this.support[e]||(this.support[e]=Ri(()=>this.registry[e]))}define(e,t){this.support[e]=t}get(e){if(typeof this.registry[e]=="undefined")throw new ReferenceError(`'${e}' dependency doesn't exist.`);return this.registry[e]}wrap(e){if(!("generate"in e)){let t=Object.keys(e),r={},a=t.length;for(;a--;){let l=t[a].replace(/^x-/,""),f=this.support[l];if(typeof f=="function"){Object.defineProperty(e,"generate",{configurable:!1,enumerable:!1,writable:!1,value:(c,E)=>f.call(r,e[t[a]],e,t[a],c,E.slice())});break}}}return e}},rn=tn,et=new tr,sr=_i,nn=class extends Error{constructor(e,t){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="ParseError",this.message=e,this.path=t}},Ot=nn,lt={array:["additionalItems","items","maxItems","minItems","uniqueItems"],integer:["exclusiveMaximum","exclusiveMinimum","maximum","minimum","multipleOf"],object:["additionalProperties","dependencies","maxProperties","minProperties","patternProperties","properties","required"],string:["maxLength","minLength","pattern","format"]},lt.number=lt.integer,sn=["additionalItems","items","additionalProperties","dependencies","patternProperties","properties"],on=Mi,an=ki,ln=an,un=ln,cn=Ni,fn=cn,pn=fn,dn=Ci,or=$i,hn=xi,mn=`Lorem ipsum dolor sit amet consectetur adipisicing elit sed do eiusmod tempor incididunt ut labore
et dolore magna aliqua Ut enim ad minim veniam quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
commodo consequat Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
pariatur Excepteur sint occaecat cupidatat non proident sunt in culpa qui officia deserunt mollit anim id est
laborum`.split(/\W/),At=Di,bt={type:Ve.ALLOWED_TYPES},gn=Fi,ar=Wi,yn=Ui,Tt=ji,wn=Bi,Sn=Vi,lr="[a-zA-Z][a-zA-Z0-9+-.]*",Pt=`https?://{hostname}(?:${lr})+`,En="(?:\\?([a-z]{1,7}(=\\w{1,5})?&){0,3})?",xe={email:"[a-zA-Z\\d][a-zA-Z\\d-]{1,13}[a-zA-Z\\d]@{hostname}",hostname:"[a-zA-Z]{1,33}\\.[a-z]{2,4}",ipv6:"[a-f\\d]{4}(:[a-f\\d]{4}){7}",uri:Pt,slug:"[a-zA-Z\\d_-]+","uri-reference":`${Pt}${En}`,"uri-template":Pt.replace("(?:","(?:/\\{[a-z][:a-zA-Z0-9-]*\\}|"),"json-pointer":`(/(?:${lr.replace("]*","/]*")}|~[01]))+`,uuid:"^[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$",duration:"^P(?!$)((\\d+Y)?(\\d+M)?(\\d+D)?(T(?=\\d)(\\d+H)?(\\d+M)?(\\d+S)?)?|(\\d+W)?)$"},xe.iri=xe["uri-reference"],xe["iri-reference"]=xe["uri-reference"],xe["idn-email"]=xe.email,xe["idn-hostname"]=xe.hostname,vn=new RegExp(`\\{(${Object.keys(xe).join("|")})\\}`),On=Yi,An=qi,bn={boolean:un,null:pn,array:dn,integer:hn,number:or,object:gn,string:An},ut=bn,Tn=Xe,Pn=({refs:e,schema:t,container:r,synchronous:a,refDepthMax:l,refDepthMin:f})=>{let c={},E={},C=0,S,D;return c.resolveSchema=(A,Y,U)=>{if(A==null)return null;if(typeof A.generate=="function")return A;if(typeof(A.$id||A.id)=="string"&&(delete A.id,delete A.$id,delete A.$schema),typeof A.$ref=="string"){let G=Math.max(f,l)-1;if(A.$ref==="#"||E[A.$ref]<0||S===A.$ref&&++C>G)return A.$ref!=="#"&&D&&D.length===U.length?ue.getLocalRef(t,A.$ref,a&&e):(delete A.$ref,A);typeof E[A.$ref]=="undefined"&&(E[A.$ref]=Q.number(f,l)-1),D=U,S=A.$ref;let X;A.$ref.indexOf("#/")===-1?X=e[A.$ref]||null:X=ue.getLocalRef(t,A.$ref,a&&e)||null;let fe;if(typeof X!="undefined"){if(!X&&z("ignoreMissingRefs")!==!0)throw new Error(`Reference not found: ${A.$ref}`);E[A.$ref]-=1,ue.merge(A,X||{}),fe=a&&X&&X.$ref}return fe||delete A.$ref,A}if(Array.isArray(A.allOf)){let G=A.allOf;delete A.allOf,G.forEach(X=>{let fe=c.resolveSchema(X,null,U);ue.merge(A,typeof fe.thunk=="function"?fe.thunk(A):fe),Array.isArray(A.allOf)&&c.resolveSchema(A,Y,U)})}if(Array.isArray(A.oneOf||A.anyOf)&&U[U.length-2]!=="dependencies"){let G=A.oneOf||A.anyOf;return A.enum&&A.oneOf&&(A.enum=A.enum.filter(X=>ue.validate(X,G))),{thunk(X){let fe=ue.omitProps(A,["anyOf","oneOf"]),de=Q.pick(G);return ue.merge(fe,de),G.forEach(F=>{F.required&&F!==de&&F.required.forEach(g=>{if(de.required&&de.required.includes(g))return;let w=fe.required&&fe.required.includes(g);fe.properties&&!w&&delete fe.properties[g],X&&X.properties&&delete X.properties[g]})}),fe}}}if(Object.keys(A).forEach(G=>{(Array.isArray(A[G])||typeof A[G]=="object")&&!ue.isKey(G)&&(A[G]=c.resolveSchema(A[G],G,U.concat(G)))}),U){let G=U[U.length-1];if(G==="properties"||G==="items")return A}return r.wrap(A)},c},Rn=Pn,ur=Qi,cr=Zi,Ie=Qt(Vr(),1),es=Ie.default.binaryOptions,ts=Ie.default.boolOptions,rs=Ie.default.intOptions,ns=Ie.default.nullOptions,is=Ie.default.strOptions,ss=Ie.default.Schema,os=Ie.default.Alias,as=Ie.default.Collection,ls=Ie.default.Merge,us=Ie.default.Node,cs=Ie.default.Pair,fs=Ie.default.Scalar,_n=Ie.default.YAMLMap,In=Ie.default.YAMLSeq,ct=Xi,He=new rn,ye=(e,t,r)=>(console.debug("[json-schema-faker] calling JSONSchemaFaker() is deprecated, call either .generate() or .resolve()"),r&&console.debug("[json-schema-faker] local references are only supported by calling .resolve()"),ye.generate(e,t)),ye.generateWithContext=(e,t)=>{let r=kr(t,e);return ur(r,e,He,!0)},ye.generate=(e,t)=>cr(ye.generateWithContext(e,t)),ye.generateYAML=(e,t)=>ct(ye.generateWithContext(e,t)),ye.resolveWithContext=(e,t,r)=>{typeof t=="string"&&(r=t,t={}),r=r||(typeof process!="undefined"&&typeof process.cwd=="function"?process.cwd():""),r=`${r.replace(/\/+$/,"")}/`;let a=kr(t,e),l={order:1,canRead(c){let E=c.url.replace("/:",":");return a[E]||a[E.split("/").pop()]},read(c,E){try{E(null,this.canRead(c))}catch(C){E(C)}}},{$RefParser:f}=er();return f.bundle(r,e,{resolve:{file:{order:100},http:{order:200},fixedRefs:l},dereference:{circular:"ignore"}}).then(c=>ur(a,c,He)).catch(c=>{throw new Error(`Error while resolving schema (${c.message})`)})},ye.resolve=(e,t,r)=>ye.resolveWithContext(e,t,r).then(cr),ye.resolveYAML=(e,t,r)=>ye.resolveWithContext(e,t,r).then(ct),Mr(),ye.format=sr,ye.option=z,ye.random=Q,ye.extend=(e,t)=>(He.extend(e,t),ye),ye.define=(e,t)=>(He.define(e,t),ye),ye.reset=e=>(He.reset(e),Mr(),ye),ye.locate=e=>He.get(e),ye.VERSION="0.5.5",Mn={...ye},kn=ye}}),ds=j({"src/src/main.iife.js"(e,t){var r=(ps(),ae(ve));typeof $RefParser!="undefined"&&typeof JSONPath!="undefined"&&r.setDependencies({...JSONPath,$RefParser}),typeof window!="undefined"&&(window.JSONSchemaFaker=r.default),t.exports=r.default,t.exports.JSONSchemaFaker=r.JSONSchemaFaker}});return ds()})();(function($,s){$.JSONSchemaFaker=s()})(typeof self!="undefined"?self:typeof window!="undefined"?window:globalThis,()=>jt);jt.random.shuffle=function(){return["[placeholder]"]};jt.option({useDefaultValue:!0,alwaysFakeOptionals:!0});function di($){return jt.generate($)}function hi($){console.log(`
${me.bold(me.underline("Discovered workflowId:"))} '${$.workflowId}'`),$.steps.forEach((s,d)=>{let y=d===$.steps.length-1;console.log(`${y?"\u2514":"\u251C"} ${Ae.STEP} Discovered stepId: '${s.stepId}'	Type: '${s.type}'`),s.providers.forEach((j,x)=>{let te=x===s.providers.length-1;console.log(`${y?" ":"\u2502"} ${te?"\u2514":"\u251C"} ${Ae.PROVIDER} Discovered provider: '${j.type}'`)})})}function vr($,s){let d={...$};for(let y of Object.keys(s)){let P=s[y];P&&typeof P=="object"&&!Array.isArray(P)?d[y]=vr(d[y]||{},P):(Array.isArray(P),d[y]=P)}return d}function Cs(){return["development",void 0].includes(process.env.NODE_ENV)}var mt=class{constructor(s){this.discoveredWorkflows=new Map;this.discoverWorkflowPromises=new Map;this.templateEngine=new Ls({outputEscape:s=>hr(s)});this.version="2.5.0";let d=this.buildOptions(s);this.apiUrl=d.apiUrl,this.secretKey=d.secretKey,this.strictAuthentication=d.strictAuthentication,this.templateEngine.registerFilter("json",(y,P)=>hr(y,P))}buildOptions(s){let d={apiUrl:kt(s==null?void 0:s.apiUrl),secretKey:Nt(s==null?void 0:s.secretKey),strictAuthentication:!Cs()};return(s==null?void 0:s.strictAuthentication)!==void 0?d.strictAuthentication=s.strictAuthentication:process.env.NOVU_STRICT_AUTHENTICATION_ENABLED!==void 0&&(d.strictAuthentication=process.env.NOVU_STRICT_AUTHENTICATION_ENABLED==="true"),d}async addWorkflows(s){for(let d of s){if(this.discoveredWorkflows.has(d.id))continue;let y=this.discoverWorkflowPromises.get(d.id);if(y){await y;continue}let P=this.addWorkflow(d);this.discoverWorkflowPromises.set(d.id,P),await P}}async addWorkflow(s){try{let d=await s.discover();hi(d),this.discoveredWorkflows.set(s.id,d)}finally{this.discoverWorkflowPromises.delete(s.id)}}healthCheck(){let s=this.getRegisteredWorkflows(),d=s.length,y=s.reduce((P,j)=>P+j.steps.length,0);return{status:"ok",sdkVersion:"2.5.0",frameworkVersion:"2024-06-26",discovered:{workflows:d,steps:y}}}getWorkflow(s){let d=this.discoveredWorkflows.get(s);if(d)return d;throw new yr(s)}getStep(s,d){let P=this.getWorkflow(s).steps.find(j=>j.stepId===d);if(P)return P;throw new zn(d)}getRegisteredWorkflows(){return Array.from(this.discoveredWorkflows.values())}discover(){return{workflows:this.getRegisteredWorkflows()}}mock(s){return di(s)}async validate(s,d,y,P,j,x,te){let ae=await Ut(d,s);if(ae.success)return ae.data;switch(y){case"event":this.throwInvalidEvent(P,j,ae.errors);case"step":this.throwInvalidStep(x,P,j,ae.errors);case"provider":this.throwInvalidProvider(x,te,P,j,ae.errors);default:throw new Error(`Invalid component: '${y}'`)}}throwInvalidProvider(s,d,y,P,j){if(!s)throw new Error("stepId is required");if(!d)throw new Error("providerId is required");switch(y){case"output":throw new Un(P,s,d,j);default:throw new Error(`Invalid payload type: '${y}'`)}}throwInvalidStep(s,d,y,P){if(!s)throw new Error("stepId is required");switch(d){case"output":throw new Dn(y,s,P);case"result":throw new Fn(y,s,P);case"controls":throw new xn(y,s,P);default:throw new Error(`Invalid payload type: '${d}'`)}}throwInvalidEvent(s,d,y){switch(s){case"controls":throw new $n(d,y);case"payload":throw new dr(d,y);default:throw new Error(`Invalid payload type: '${s}'`)}}executeStepFactory(s,d,y){return async(P,j,x)=>{if(y())return;let te=this.getStep(s.workflowId,P),ae=s.action==="preview";if(!ae&&P===s.stepId){let Ne=await this.createStepControls(te,s);if(await this.shouldSkip(x==null?void 0:x.skip,Ne))return d({options:{skip:!0},outputs:{},providers:{}}),{}}let ve=this.previewStep.bind(this),ke=this.executeStep.bind(this),be=await(ae?ve:ke)(s,{...te,providers:te.providers.map(Ne=>{var Qe;let $e=(Qe=x==null?void 0:x.providers)==null?void 0:Qe[Ne.type];if(!$e)throw new Hn(Ne.type);return{...Ne,resolve:$e}}),resolve:j});return Object.values(pr).includes(te.type)&&(x==null?void 0:x.disableOutputSanitization)!==!0&&(be={...be,outputs:Lt(be.outputs)}),P===s.stepId&&d({...be,options:{skip:!1}}),be.outputs}}async shouldSkip(s,d){return s?s(d):!1}async executeWorkflow(s){let P=`${{execute:"Executing",preview:"Previewing"}[s.action]} workflowId:`;console.log(`
${me.bold(me.underline(P))} '${s.workflowId}'`);let j=this.getWorkflow(s.workflowId),x=process.hrtime(),te={outputs:{},providers:{},options:{skip:!1}},ae,ve=!1,ke=new Promise(je=>{ae=je}),Le=je=>{if(ve)throw new Error("setResult can only be called once per workflow execution");ae(),ve=!0,te=je},be=()=>ve,Ne;try{if(s.action==="execute"&&!s.payload)throw new dr(s.workflowId,{message:"Event `payload` is required"});let je=await this.createExecutionPayload(s,j),Be={...s,payload:je};await Promise.race([ke,j.execute({payload:je,environment:{},controls:{},subscriber:s.subscriber,step:{email:this.executeStepFactory(Be,Le,be),sms:this.executeStepFactory(Be,Le,be),inApp:this.executeStepFactory(Be,Le,be),digest:this.executeStepFactory(Be,Le,be),delay:this.executeStepFactory(Be,Le,be),push:this.executeStepFactory(Be,Le,be),chat:this.executeStepFactory(Be,Le,be),custom:this.executeStepFactory(Be,Le,be)}})])}catch(je){Ne=je}let $e=process.hrtime(x),Qe=$e[0],Ue=$e[1],yt=Qe*1e3+Ue/1e6,Bt=Ne?Ae.ERROR:Ae.SUCCESS,wt={execute:"Executed",preview:"Previewed"}[s.action];if(console.log(`${Bt} ${wt} workflowId: \`${s.workflowId}\``),this.prettyPrintExecute(s,yt,Ne),Ne)throw Ne;return{outputs:te.outputs,providers:te.providers,options:te.options,metadata:{status:"success",error:!1,duration:yt}}}async createExecutionPayload(s,d){let{payload:y}=s;if(s.action==="preview"){let j=this.mock(d.payload.schema);y=Object.assign(j,y)}return await this.validate(y,d.payload.unknownSchema,"event","payload",s.workflowId)}prettyPrintExecute(s,d,y){let P=y?Ae.ERROR:Ae.SUCCESS,x={execute:"Executed",preview:"Previewed"}[s.action],te=y?"Failed to execute":x,ae=y?me.error:me.success,ve=`${P} ${te} workflowId: '${s.workflowId}`;console.log(`
  ${me.bold(ae(ve))}'`),console.log(`  \u251C ${Ae.STEP} stepId: '${s.stepId}'`),console.log(`  \u251C ${Ae.ACTION} action: '${s.action}'`),console.log(`  \u2514 ${Ae.DURATION} duration: '${d.toFixed(2)}ms'
`)}async executeProviders(s,d,y){return d.providers.reduce(async(P,j)=>{let x=await P,te=this.previewProvider.bind(this),ae=this.executeProvider.bind(this),ke=await(s.action==="preview"?te:ae)(s,d,j,y);return{...x,[j.type]:ke}},Promise.resolve({}))}previewProvider(s,d,y,P){return console.log(`  ${Ae.MOCK} Mocked provider: \`${y.type}\``),this.mock(y.outputs.schema)}async executeProvider(s,d,y,P){try{if(s.stepId===d.stepId){let j=await this.createStepControls(d,s),x=await y.resolve({controls:j,outputs:P}),te=await this.validate(x,y.outputs.unknownSchema,"step","output",s.workflowId,d.stepId,y.type);return console.log(`  ${Ae.SUCCESS} Executed provider: \`${y.type}\``),{...te,_passthrough:x._passthrough}}else return console.log(`  ${Ae.HYDRATED} Hydrated provider: \`${y.type}\``),{}}catch(j){throw console.log(`  ${Ae.ERROR} Failed to execute provider: \`${y.type}\``),new qn(y.type,s.action,j)}}async executeStep(s,d){if(s.stepId===d.stepId)try{let y=await this.createStepControls(d,s),P=await this.compileControls(y,s),j=await d.resolve(P),x=await this.validate(j,d.outputs.unknownSchema,"step","output",s.workflowId,d.stepId),te=await this.executeProviders(s,d,x);return console.log(`  ${Ae.SUCCESS} Executed stepId: \`${d.stepId}\``),{outputs:x,providers:te}}catch(y){throw console.log(`  ${Ae.ERROR} Failed to execute stepId: \`${d.stepId}\``),pt(y)?y:new gr(d.stepId,s.action,y)}else try{let y=this.getStepState(s,d.stepId);if(y){let P=await this.validate(y.outputs,d.results.unknownSchema,"step","result",s.workflowId,d.stepId);return console.log(`  ${Ae.HYDRATED} Hydrated stepId: \`${d.stepId}\``),{outputs:P,providers:await this.executeProviders(s,d,P)}}else throw new Cn(s.workflowId,d.stepId)}catch(y){throw console.log(`  ${Ae.ERROR} Failed to hydrate stepId: \`${d.stepId}\``),y}}async compileControls(s,d){try{let y=this.templateEngine.parse(JSON.stringify(s)),P=await this.templateEngine.render(y,{payload:d.payload,subscriber:d.subscriber,steps:$s(d.state)});return JSON.parse(P)}catch(y){throw new Wn(d.workflowId,d.stepId,y)}}async createStepControls(s,d){return await this.validate(d.controls,s.controls.unknownSchema,"step","controls",d.workflowId,s.stepId)}async previewStep(s,d){try{return await this.constructStepForPreview(s,d)}catch(y){throw console.log(`  ${Ae.ERROR} Failed to preview stepId: \`${d.stepId}\``),pt(y)?y:new gr(d.stepId,s.action,y)}}async constructStepForPreview(s,d){return s.stepId===d.stepId?await this.previewRequiredStep(d,s):await this.extractMockDataForPreviousSteps(s,d)}async extractMockDataForPreviousSteps(s,d){let y={},P=this.getStepState(s,d.stepId),j=this.mock(d.results.schema);return{outputs:vr(j,(P==null?void 0:P.outputs)||{}),providers:await this.executeProviders(s,d,y)}}async previewRequiredStep(s,d){let y=await this.createStepControls(s,d),P=await this.compileControls(y,d),j=await s.resolve(P),x=await this.validate(j,s.outputs.unknownSchema,"step","output",d.workflowId,s.stepId);return console.log(`  ${Ae.MOCK} Mocked stepId: \`${s.stepId}\``),{outputs:x,providers:await this.executeProviders(d,s,x)}}getStepState(s,d){return s.state.find(y=>y.stepId===d)}getStepCode(s,d){return{code:this.getStep(s,d).resolve.toString()}}getWorkflowCode(s){return{code:this.getWorkflow(s).execute.toString()}}getCode(s,d){let y;if(s)d?y=this.getStepCode(s,d):y=this.getWorkflowCode(s);else throw new yr(s);return y}};function $s($){let s={};for(let d of $)s[d.stepId]=d.outputs;return s}var Or=class{constructor(s){this.handler=s.handler,this.client=s.client?s.client:new mt,this.workflows=s.workflows,this.http=Mt(this.client.secretKey,this.client.apiUrl),this.frameworkName=s.frameworkName,this.hmacEnabled=this.client.strictAuthentication}createHandler(){return async(...s)=>{await this.client.addWorkflows(this.workflows);let d=await this.handler(...s),y=await this.handleAction({actions:d});return d.transformResponse(y)}}getStaticHeaders(){let s=`novu-framework:v${this.client.version}`;return{"content-type":"application/json","access-control-allow-origin":"*","access-control-allow-methods":"GET, POST","access-control-allow-headers":"*","access-control-max-age":"604800","novu-framework-version":"2024-06-26","novu-framework-sdk":"2.5.0","novu-framework-server":this.frameworkName,"user-agent":s}}createResponse(s,d){return{status:s,body:JSON.stringify(d),headers:{...this.getStaticHeaders()}}}createError(s){return{status:s.statusCode,body:JSON.stringify({message:s.message,data:s.data,code:s.code}),headers:this.getStaticHeaders()}}async handleAction({actions:s}){let d=await s.url(),y=await s.method(),P=d.searchParams.get("action")||"health-check",j=d.searchParams.get("workflowId")||"",x=d.searchParams.get("stepId")||"",te=await s.headers("novu-signature")||"",ae={};try{y==="POST"&&(ae=await s.body())}catch{}try{P!=="health-check"&&await this.validateHmac(ae,te);let ve=this.getPostActionMap(ae,j,x,P),ke=this.getGetActionMap(j,x);if(y==="POST")return await this.handlePostAction(P,ve);if(y==="GET")return await this.handleGetAction(P,ke);if(y==="OPTIONS")return this.createResponse(200,{})}catch(ve){return this.handleError(ve)}return this.createError(new Bn(y))}getPostActionMap(s,d,y,P){return{trigger:this.triggerAction({workflowId:d,...s}),execute:async()=>{let j=await this.client.executeWorkflow({...s,workflowId:d,stepId:y,action:P});return this.createResponse(200,j)},preview:async()=>{let j=await this.client.executeWorkflow({...s,workflowId:d,stepId:y,action:P});return this.createResponse(200,j)}}}triggerAction(s){return async()=>{let d={name:s.workflowId,to:s.to,payload:(s==null?void 0:s.payload)||{},transactionId:s.transactionId,overrides:s.overrides||{},...s.actor&&{actor:s.actor},...s.bridgeUrl&&{bridgeUrl:s.bridgeUrl},...s.controls&&{controls:s.controls}},y=await this.http.post("/events/trigger",d);return this.createResponse(200,y)}}getGetActionMap(s,d){return{discover:async()=>{let y=await this.client.discover();return this.createResponse(200,y)},"health-check":async()=>{let y=await this.client.healthCheck();return this.createResponse(200,y)},code:async()=>{let y=await this.client.getCode(s,d);return this.createResponse(200,y)}}}async handlePostAction(s,d){if(Object.values(_t).includes(s)){let y=d[s];return y()}else throw new mr(s,_t)}async handleGetAction(s,d){if(Object.values(fr).includes(s)){let y=d[s];return y()}else throw new mr(s,fr)}handleError(s){if(pt(s))return s.statusCode>=500&&console.error(s),this.createError(s);if(ei(s))return this.createError(s);{let d=new It(s);return console.error(d),this.createError(d)}}async validateHmac(s,d){if(!this.hmacEnabled)return;if(!d)throw new Jn;if(!this.client.secretKey)throw new Zn;let[y,P]=d.split(",");if(!y||!P)throw new Gn;let[j,x]=y.split("="),[te,ae]=P.split("=");if(Number(j)<Date.now()-1500)throw new Qn;if(!(await ri(this.client.secretKey,`${x}.${JSON.stringify(s)}`)===ae))throw new Kn}};async function nt($,s,d){if($.steps.some(y=>y.stepId===s))throw new Xn(s);$.steps.push(d)}async function Ar($,s,d,y){return async(P,j,x={})=>{let te=(x==null?void 0:x.controlSchema)||Fe;return await nt($,P,{stepId:P,type:s,controls:{schema:await Re(te),unknownSchema:te},outputs:{schema:await Re(d),unknownSchema:d},results:{schema:await Re(y),unknownSchema:y},resolve:j,code:j.toString(),options:x,providers:[]}),{_ctx:{timestamp:Date.now(),state:{status:"pending",error:!1}}}}}async function mi($,s,d){let y=ti[s],P=Object.entries(d).map(async([j,x])=>{let te=y[j];return{type:j,code:x.toString(),resolve:x,outputs:{schema:await Re(te.output),unknownSchema:te.output}}});$.providers.push(...await Promise.all(P))}async function it($,s,d,y){return async(P,j,x={})=>{let te=(x==null?void 0:x.controlSchema)||Fe,ae={stepId:P,type:s,controls:{schema:await Re(te),unknownSchema:te},outputs:{schema:await Re(d),unknownSchema:d},results:{schema:await Re(y),unknownSchema:y},resolve:j,code:j.toString(),options:x,providers:[]};return await nt($,P,ae),Object.keys(x.providers||{}).length>0&&await mi(ae,s,x.providers||{}),{_ctx:{timestamp:Date.now(),state:{status:"pending",error:!1}}}}}async function gi($,s){return async(d,y,P={})=>{let j=(P==null?void 0:P.controlSchema)||Fe,x=(P==null?void 0:P.outputSchema)||Fe;return await nt($,d,{stepId:d,type:s,controls:{schema:await Re(j),unknownSchema:j},outputs:{schema:await Re(x),unknownSchema:x},results:{schema:await Re(x),unknownSchema:x},resolve:y,code:y.toString(),options:P,providers:[]}),{_ctx:{timestamp:Date.now(),state:{status:"pending",error:!1}}}}}import{ChannelTypeEnum as gt}from"@novu/shared";var xs={email:gt.EMAIL,sms:gt.SMS,push:gt.PUSH,inApp:gt.IN_APP,chat:gt.CHAT};function yi($){if(!$)return{};let s={};return $.all&&(s.all=$.all),Object.entries($.channels||{}).forEach(([d,y])=>{let P=xs[d];P&&(s.channels||(s.channels={}),s.channels[P]=y)}),s}function Ds($,s,d){let y=d||{};return{id:$,trigger:async x=>{let te=Mt(Nt(x.secretKey),kt(x.apiUrl)),ae=x.payload||{},ve;if(y.payloadSchema){let $e=await Ut(y.payloadSchema,ae);if($e.success===!1)throw new jn($,$e.errors);ve=$e.data}else ve=x.payload;let ke=await ni(),Le={name:$,to:x.to,payload:{...ve},...x.transactionId&&{transactionId:x.transactionId},...x.overrides&&{overrides:x.overrides},...x.actor&&{actor:x.actor},...ke&&{bridgeUrl:ke}},be=await te.post("/events/trigger",Le);return{cancel:async()=>te.delete(`/events/trigger/${be.transactionId}`),data:be}},discover:async()=>{let x={workflowId:$,steps:[],code:s.toString(),payload:{schema:await Re(y.payloadSchema||Fe),unknownSchema:y.payloadSchema||Fe},controls:{schema:await Re(y.controlSchema||Fe),unknownSchema:y.controlSchema||Fe},tags:y.tags||[],preferences:yi(y.preferences),name:y.name,description:y.description,execute:s};return await s({payload:{},subscriber:{},environment:{},controls:{},step:{push:await it(x,"push",We.push.output,We.push.result),chat:await it(x,"chat",We.chat.output,We.chat.result),email:await it(x,"email",We.email.output,We.email.result),sms:await it(x,"sms",We.sms.output,We.sms.result),inApp:await it(x,"in_app",We.in_app.output,We.in_app.result),digest:await Ar(x,"digest",Sr.output,Sr.result),delay:await Ar(x,"delay",wr.output,wr.result),custom:await gi(x,"custom")}}),x}}}export{Us as a,mt as b,Or as c,Ds as d};
